<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CompareHubPrices - Business Account Manager</title>


    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline' https://challenges.cloudflare.com https://accounts.google.com https://www.google.com https://www.gstatic.com https://apis.google.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://accounts.google.com https://fonts.googleapis.com https://www.gstatic.com; img-src 'self' data: https://www.gstatic.com https://assets.comparehubprices.co.za; font-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://fonts.gstatic.com; connect-src 'self' https://hub.comparehubprices.co.za https://accounts.google.com https://www.google.com https://www.gstatic.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; frame-src 'self' https://challenges.cloudflare.com https://accounts.google.com https://www.google.com https://www.gstatic.com;">

    <link rel="icon" type="image/x-icon" href="/assets/icons/favicon.ico">
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://challenges.cloudflare.com" crossorigin>

    <!-- Google Fonts: Outfit (Headings) & Inter (Body) -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">

    <!-- QR Code Library - Load early -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">




    <link rel="stylesheet" href="assets/css/styles.css">


    <link rel="stylesheet" href="assets/css/header.css">

    <link rel="stylesheet" href="assets/css/my account info.css">
    <link rel="stylesheet" href="assets/css/contact-us.css">
    <link rel="stylesheet" href="assets/css/business_analytics.css">
    <link rel="stylesheet" href="assets/css/badge.css">

    <style>
        /* Global Font Updates */
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        .hero-d3 h1,
        .chart-title,
        .header-label-d4 {
            font-family: 'Outfit', system-ui, -apple-system, sans-serif;
        }

        /* HERO DESIGN 3: Glassmorphism Card (Consolidated from Business Management) */
        .hero-d3-wrapper {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 50%, #004085 100%);
            /* Blue background */
            padding: 60px;
            border-radius: 0 0 20px 20px;
            margin-bottom: 30px;
            margin-top: 0px;
            /* Align to top on desktop */
            position: relative;
        }

        .hero-d3 {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border-radius: 16px;
            padding: 40px;
            display: flex;
            align-items: flex-start;
            gap: 20px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 1000px;
            margin: 0 auto;
        }

        .hero-d3 .icon {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 50%, #004085 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .hero-d3 h1 {
            margin: 0;
            font-size: 1.8rem;
            font-weight: 800;
            color: #1e293b;
        }

        .hero-d3 p {
            margin: 5px 0 0 0;
            color: #555;
        }

        /* Action button in hero */
        .hero-actions {
            margin-left: auto;
        }

        .hero-btn {
            background: #ffffff;
            color: #0f172a;
            border: 1px solid #e2e8f0;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .hero-btn:hover {
            background: #f8fafc;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        /* Mobile Optimization for Hero Design 3 */
        @media (max-width: 768px) {
            .hero-d3-wrapper {
                padding: 60px 15px 30px 15px;
                margin-top: -150px;
                /* Pull up on mobile */
            }

            .hero-d3 {
                flex-direction: column;
                align-items: center;
                text-align: center;
                padding: 25px;
            }

            .hero-d3 .icon {
                margin-bottom: 10px;
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }

            .hero-d3 h1 {
                font-size: 1.5rem;
            }

            .hero-d3 p {
                font-size: 0.95rem;
            }

            .hero-actions {
                margin-left: 0;
                margin-top: 15px;
                width: 100%;
                display: flex;
                justify-content: center;
            }
        }

        /* Breadcrumb Alignment */
        .breadcrumb-container {
            width: 100%;
            margin-bottom: 20px;
            display: flex;
            justify-content: flex-start;
            padding-left: 0;
        }
    </style>

    <style>
        /* Loading Overlay */
        .page-loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .page-loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-content {
            text-align: center;
            color: #333;
        }

        .logo-container {
            margin-bottom: 3rem;
        }

        .logo-container img {
            max-width: 200px;
            height: auto;
        }

        /* Modern Spinner */
        .modern-spinner {
            position: relative;
            width: 60px;
            height: 60px;
            margin: 0 auto 2rem auto;
        }

        .spinner-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid transparent;
            border-top: 3px solid #dc3545;
            border-radius: 50%;
            animation: spin 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
        }

        .spinner-ring:nth-child(1) {
            animation-delay: -0.45s;
            border-top-color: #dc3545;
        }

        .spinner-ring:nth-child(2) {
            animation-delay: -0.3s;
            border-top-color: #28a745;
            width: 80%;
            height: 80%;
            top: 10%;
            left: 10%;
        }

        .spinner-ring:nth-child(3) {
            animation-delay: -0.15s;
            border-top-color: #007bff;
            width: 60%;
            height: 60%;
            top: 20%;
            left: 20%;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loading-content h4 {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        /* Modal Scrolling */
        .modal-body {
            max-height: calc(100vh - 200px);
            overflow-y: auto;
            padding: 1.5rem;
        }

        .modal-body::-webkit-scrollbar {
            width: 8px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        /* CSS Rings Design (Design 40 adapted) */
        .css-ring-container {
            display: flex;
            justify-content: space-around;
            width: 100%;
            flex-wrap: wrap;
            gap: 20px;
        }

        .css-ring-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .css-ring {
            --size: 80px;
            --bar-width: 8px;
            width: var(--size);
            height: var(--size);
            border-radius: 50%;
            background: radial-gradient(closest-side, #ffffff 79%, transparent 80% 100%),
                conic-gradient(var(--fill-color) calc(var(--p) * 1%), #e2e8f0 0);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .css-ring span {
            font-weight: 700;
            font-size: 1rem;
            color: #1e293b;
            z-index: 10;
        }

        .ring-label {
            font-size: 0.85rem;
            color: #64748b;
            font-weight: 500;
        }

        .stats-grid-rings {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 30px;
        }

        .modal-body::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Ensure modals are scrollable on mobile */
        @media (max-height: 600px) {
            .modal-body {
                max-height: calc(100vh - 150px);
            }
        }

        .loading-content p {
            font-size: 1rem;
            color: #666;
            margin: 0;
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .modern-spinner {
                width: 50px;
                height: 50px;
            }

            .loading-content h4 {
                font-size: 1.25rem;
            }

            .loading-content p {
                font-size: 0.9rem;
            }

            .logo-container img {
                max-width: 150px;
            }
        }

        /* Toast Notification Styling */
        .toast-container {
            z-index: 9999 !important;
        }

        .toast {
            min-width: 350px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
            border-radius: 8px !important;
            overflow: hidden;
            border: none !important;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
            padding: 12px 16px !important;
            font-weight: 600;
        }

        .toast-body {
            padding: 16px !important;
            font-size: 14px;
            line-height: 1.5;
            color: #333;
        }

        @media (max-width: 576px) {
            .toast {
                min-width: calc(100vw - 40px);
                max-width: calc(100vw - 40px);
            }

            .toast-container {
                top: 70px !important;
                right: 10px !important;
            }
        }
    </style>
    <style>
        /* Recent Followers Styles (Design 41 modified) */
        .follower-item {
            display: flex;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .follower-item:last-child {
            border-bottom: none;
        }

        .follower-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #334155;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-right: 1rem;
            position: relative;
            flex-shrink: 0;
        }

        .follower-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .follower-info {
            flex-grow: 1;
            min-width: 0;
        }

        .follower-name {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.9rem;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .follower-meta {
            color: var(--text);
            font-size: 0.75rem;
        }

        /* Recent Reviews Styles (Design 48 Compact Star List) */
        .compact-review-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .compact-review-row:last-child {
            border-bottom: none;
        }

        .compact-review-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .compact-score-box {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .compact-score-box.avg {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .compact-score-box.bad {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .compact-review-content h4 {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-dark);
            font-weight: 600;
        }

        /* --- Stat Card Design A: Clean & Modern --- */
        .stat-card-design-a {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 1.5rem;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }

        .stat-card-design-a:hover {
            transform: translateY(-2px);
        }

        .design-a-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: #eff6ff;
            color: #3b82f6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .design-a-content {
            flex-grow: 1;
        }

        .design-a-label {
            font-size: 0.85rem;
            color: #64748b;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .design-a-number {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1e293b;
            margin: 0.25rem 0;
        }

        .design-a-change {
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .design-a-change.pos {
            color: #10b981;
        }

        .design-a-change.neg {
            color: #ef4444;
        }

        /* --- Stat Card Design B: Vibrant Gradient --- */
        .stat-card-design-b {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            border-radius: 16px;
            padding: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.3);
        }

        .stat-card-design-b::before {
            content: '';
            position: absolute;
            top: -20px;
            right: -20px;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .design-b-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .design-b-icon {
            font-size: 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }

        .design-b-value {
            font-size: 2rem;
            font-weight: 800;
            line-height: 1;
        }

        .design-b-label {
            font-size: 0.9rem;
            opacity: 0.9;
            font-weight: 500;
        }

        .design-b-pill {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        /* --- Stat Card Design C: Glassmorphism Border --- */
        .stat-card-design-c {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.25rem;
            border-left: 5px solid #3b82f6;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 100%;
        }

        .design-c-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .design-c-title {
            color: #64748b;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .design-c-icon {
            color: #cbd5e1;
            font-size: 1.1rem;
        }

        .design-c-main {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
        }

        .design-c-num {
            font-size: 1.8rem;
            font-weight: 700;
            color: #0f172a;
        }

        .design-c-trend {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
            background: #ecfdf5;
            color: #059669;
        }

        /* --- Stat Card Design D: Neumorphic Minimal --- */
        .stat-card-design-d {
            border-radius: 20px;
            background: #f0f4f8;
            /* Needs light grey bg to work well, handled by container or override */
            padding: 1.5rem;
            box-shadow: 5px 5px 10px #d1d5db, -5px -5px 10px #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .design-d-ring {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f4f8;
            box-shadow: inset 3px 3px 5px #d1d5db, inset -3px -3px 5px #ffffff;
            margin-bottom: 1rem;
            font-size: 1.5rem;
            color: #3b82f6;
        }

        .design-d-stat {
            font-size: 1.6rem;
            font-weight: 700;
            color: #334155;
        }

        .design-d-text {
            font-size: 0.85rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        /* --- Stat Card Design E: Dark Mode Tech --- */
        .stat-card-design-e {
            background: #0f172a;
            border-radius: 8px;
            padding: 1.5rem;
            position: relative;
            color: #e2e8f0;
            border: 1px solid #1e293b;
        }

        .stat-card-design-e::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #06b6d4);
            border-radius: 0 0 8px 8px;
        }

        .design-e-flex {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .design-e-label {
            font-size: 0.8rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .design-e-val {
            font-size: 2rem;
            font-weight: 700;
            color: white;
            margin-top: 0.5rem;
            display: block;
        }

        .design-e-icon-box {
            width: 40px;
            height: 40px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3b82f6;
            font-size: 1.2rem;
        }

        .design-e-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 0.7rem;
            color: #64748b;
        }

        /* Design 62 (Circle Progress) implementation */
        .stat-card-design-g {
            background: #1e293b;
            border-radius: 16px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: transform 0.2s;
        }

        .stat-card-design-g:hover {
            background: #253347;
        }

        .design-g-ring {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 4px solid #334155;
            border-top-color: #3b82f6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
        }

        .design-g-content h4 {
            margin: 0;
            font-size: 0.9rem;
            color: #94a3b8;
            font-weight: 500;
        }

        .design-g-content div {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            margin-top: 0.25rem;
        }

        .stats-grid-5 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Design 51: Leaderboard Styles */
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            background: rgba(255, 255, 255, 0.02);
            transition: background 0.2s;
        }

        .leaderboard-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .leaderboard-item:last-child {
            border-bottom: none;
        }

        .leaderboard-rank {
            font-size: 1.5rem;
            font-weight: 800;
            color: #64748b;
            min-width: 40px;
            text-align: center;
            margin-right: 1rem;
        }

        .leaderboard-item:first-child .leaderboard-rank {
            color: #eab308;
        }

        .leaderboard-item:nth-child(2) .leaderboard-rank {
            color: #94a3b8;
        }

        .leaderboard-item:nth-child(3) .leaderboard-rank {
            color: #b45309;
        }

        .leaderboard-img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
            background: #334155;
            margin-right: 1rem;
        }

        .leaderboard-info {
            flex-grow: 1;
            min-width: 0;
        }

        .leaderboard-title {
            font-weight: 600;
            color: #f8fafc;
            font-size: 1rem;
            margin-bottom: 2px;
        }

        .leaderboard-meta {
            color: #94a3b8;
            font-size: 0.8rem;
        }

        .leaderboard-stats {
            text-align: right;
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .stat-group {
            text-align: right;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #64748b;
            margin-bottom: 2px;
            text-transform: uppercase;
        }

        .leaderboard-likes {
            color: #f43f5e;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .leaderboard-trend {
            font-size: 0.75rem;
            margin-left: 4px;
        }

        .trend-up {
            color: #10b981;
        }

        .trend-down {
            color: #ef4444;
        }



        /* Design 36: Linear Progress Stack Styles */
        .rating-row {
            display: flex;
            align-items: center;
            margin-bottom: 0.6rem;
            padding: 0 1rem;
        }

        .rating-label {
            min-width: 45px;
            color: #94a3b8;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .rating-bar-bg {
            flex-grow: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            overflow: hidden;
            margin: 0 1rem;
        }

        .rating-bar-fill {
            height: 100%;
            border-radius: 4px;
        }

        .rating-count {
            min-width: 35px;
            text-align: right;
            color: #64748b;
            font-size: 0.85rem;
        }

        /* =========================================
           Page Header Design 4: Left Border Accent
           ========================================= */
        .header-d4 {
            background: #ffffff;
            border-left: 5px solid #0056b3;
            padding: 2rem;
            border-radius: 0 12px 12px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .header-d4 h1 {
            color: #1e293b !important;
            margin: 0;
            font-size: 1.6rem !important;
            font-weight: 700;
        }

        .header-d4 p {
            color: #64748b !important;
            margin: 0.25rem 0 0 0;
            font-size: 0.9rem;
        }

        .header-label-d4 {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: #0056b3;
            font-weight: 700;
            letter-spacing: 1px;
            margin-bottom: 0.25rem;
        }

        .btn-d4 {
            background: #0056b3;
            color: #fff;
            border-radius: 6px;
            padding: 0.7rem 1.4rem;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            border: none;
            box-shadow: 0 4px 10px rgba(0, 86, 179, 0.3);
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-d4:hover {
            box-shadow: 0 6px 15px rgba(0, 86, 179, 0.5);
            transform: translateY(-2px);
            background: #0056b3;
            color: white;
        }

          
    </style>





</head>

<body>




    <div class="page-loading-overlay" id="pageLoadingOverlay">
        <div class="loading-content">
            <div class="logo-container">
                <img src="assets/logo.png" alt="CompareHubPrices" class="logo-img">
            </div>
            <div class="modern-spinner">
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
            </div>
            <h4>Loading...</h4>
            <p>Please wait while we load your  analytics</p>
        </div>
    </div>


    <header class="header desktop-only">
        <div class="container-fluid">
            <div class="row align-items-center">
                <!-- Mobile Toggle Button - Left Corner -->
                <div class="col-auto mobile-tablet-only">
                    <button class="sidebar-toggle" aria-label="Open menu">â˜°</button>
                </div>

                <div class="col-auto">
                    <div class="logo">
                        <img src="assets/logo.png" alt="CompareHubPrices" class="logo-img">
                    </div>
                </div>

                <!-- Categories Dropdown - Desktop Only -->
                <div class="col-auto desktop-only">
                    <div class="categories-dropdown">
                        <a href="#categories" class="header-link">Categories <i class="fas fa-chevron-down"
                                style="font-size: 0.7em;"></i></a>
                        <div class="categories-menu">
                            <div class="categories-column">
                                <h4>Product Categories</h4>
                                <a href="#smartphones-tablets" class="category-item"
                                    data-category="smartphones-tablets">
                                    Smartphones and Tablets
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                                <a href="#laptops-accessories" class="category-item"
                                    data-category="laptops-accessories">
                                    Laptops and Accessories
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                                <a href="#wearables" class="category-item" data-category="wearables">
                                    Wearables Devices
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                                <a href="#televisions" class="category-item" data-category="televisions">
                                    Televisions & Streaming Devices
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                                <a href="#audio" class="category-item" data-category="audio">
                                    Audio
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                                <a href="#gaming" class="category-item" data-category="gaming">
                                    Gaming
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                                <a href="#networking" class="category-item" data-category="networking">
                                    Wi-Fi & Networking
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                                <a href="#appliances" class="category-item" data-category="appliances">
                                    Appliances
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                            </div>
                            <div class="categories-column subcategories-column" id="subcategories-column">
                                <h4 id="subcategory-title">Select a category</h4>
                                <div id="subcategory-content">
                                    <p>Hover over a category to see subcategories</p>
                                </div>
                            </div>
                            <div class="categories-column sub-subcategories-column" id="sub-subcategories-column">
                                <h4 id="sub-subcategory-title">Select a subcategory</h4>
                                <div id="sub-subcategory-content">
                                    <p>Hover over a subcategory to see more options</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Header Search -->
                <div class="col-auto desktop-only">
                    <div class="header-search">
                        <div class="search-wrapper">
                            <div class="input-group" style="width: 350px;">
                                <input type="text" id="headerSearchInput" placeholder="Search..."
                                    class="form-control search-input">
                                <button type="button" class="btn btn-danger search-btn" onclick="performHeaderSearch()">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <!-- Desktop Search Suggestions Dropdown -->
                            <div class="search-suggestions" id="headerSearchSuggestions">
                                <div class="suggestions-content">
                                    <!-- Suggestions will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notification Buttons - Desktop Only -->
                <div class="col desktop-only">
                    <div class="notification-buttons">
                        <a href="regular_users_chat.html" class="header-link" id="desktopMessagesLink">
                            Messages
                            <span class="wishlist-count-badge" id="desktopMessagesCount">0</span>
                        </a>
                        <a href="price-alerts.html" class="header-link" id="desktopPriceAlertsLink">
                            Price Alerts
                            <span class="wishlist-count-badge" id="desktopPriceAlertsCount">0</span>
                        </a>
                        <a href="notifications.html" class="header-link" id="desktopNotificationsLink">
                            Notifications
                            <span class="notification-badge" id="desktopNotificationCount">0</span>
                        </a>
                        <a href="local_hub.html" class="header-link" id="desktopLocalBusinessLink">LocalHub</a>
                        <div class="login-dropdown-container" id="desktopLoginContainer">
                            <a href="#" class="header-link custom-login-btn" id="desktopLoginBtn" aria-haspopup="true"
                                aria-expanded="false">
                                <span class="login-right-section">
                                    <span class="avatar-initials" id="desktopAvatarInitials"
                                        style="display: inline-flex; width: 32px; height: 32px; min-width: 32px; min-height: 32px; border-radius: 50%; background-color: #dc3545; background: #dc3545; color: white; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; margin-right: 8px; flex-shrink: 0; line-height: 32px; text-align: center;">
                                        <i class="fas fa-user"></i>
                                    </span>
                                    <span class="business-account-text" id="desktopAccountType"
                                        style="display: none;"></span>
                                    <span class="login-label" id="desktopUserName" style="display: none;"></span>
                                    <span class="login-label-default" id="desktopLoginLabel">My Account</span>
                                    <i class="fas fa-chevron-down" id="desktopLoginChevron"></i>
                                </span>
                            </a>
                            <!-- Custom Modern Dropdown -->
                            <div class="custom-login-dropdown desktop-only" aria-label="Login dropdown">
                                <div class="custom-dropdown-arrow"></div>
                                <div class="custom-dropdown-content">
                                    <!-- Logged Out State -->
                                    <div class="custom-dropdown-body">
                                        <div class="custom-dropdown-actions">
                                            <a href="login.html"
                                                class="custom-dropdown-btn custom-dropdown-btn-primary">
                                                <i class="fas fa-sign-in-alt"></i>
                                                <span>Login</span>
                                            </a>
                                            <a href="register_regular.html"
                                                class="custom-dropdown-btn custom-dropdown-btn-secondary">
                                                <i class="fas fa-user-plus"></i>
                                                <span>Create Account</span>
                                            </a>
                                            <a href="business_register.html"
                                                class="custom-dropdown-btn custom-dropdown-btn-secondary">
                                                <i class="fas fa-briefcase"></i>
                                                <span>Business Account</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Header -->
    <header class="mobile-header mobile-tablet-only">
        <div class="mobile-header-container">
            <div class="mobile-header-top">
                <!-- Toggle Button -->
                <button class="btn btn-outline-secondary sidebar-toggle" aria-label="Open menu"
                    onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>

                <!-- Logo -->
                <div class="mobile-logo">
                    <img src="assets/logo.png" alt="CompareHubPrices" class="mobile-logo-img">
                </div>
            </div>

            <div class="mobile-header-bottom">
                <!-- Search Input -->
                <div class="mobile-search">
                    <div class="input-group">
                        <input type="text" id="mobileHeaderSearchInput" placeholder="Search..."
                            class="form-control mobile-search-input">
                        <button type="button" class="btn btn-danger search-btn" onclick="performMobileHeaderSearch()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <!-- Search Suggestions Dropdown -->
                    <div class="mobile-search-suggestions" id="mobileHeaderSearchSuggestions">
                        <div class="suggestions-content">
                            <!-- Suggestions will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile/Tablet Sidebar -->
    <div class="mobile-sidebar" id="mobileSidebar">
        <div class="sidebar-content p-0">
            <!-- Welcome Header with Close Button -->
            <div class="bg-danger text-white py-2 px-3 d-flex justify-content-between align-items-center">
                <span class="small fw-bold">Welcome back to CompareHubPrices</span>
                <button class="btn-close btn-close-white btn-sm" onclick="toggleSidebar()" aria-label="Close"></button>
            </div>


            <!-- LOGGED OUT STATE - Show this when user is not logged in -->
            <div id="loggedOutState" class="px-3 py-2">
                <button class="btn btn-danger w-100 d-flex justify-content-center align-items-center"
                    onclick="toggleLoginState(); return false;">
                    <i class="fas fa-sign-in-alt" style="margin-right: 8px;"></i>
                    Login
                </button>
            </div>

            <!-- LOGGED IN STATE - Design 1: Classic Gradient Card -->
            <div id="loggedInState" class="login-after-card-wrapper" style="display: none;">
                <div class="login-after-card">
                    <div class="user-section">
                        <div class="user-avatar" id="sidebarUserAvatar">JD</div>
                        <div class="user-info">
                            <h4 id="sidebarUserName">John Doe</h4>
                            <p id="sidebarUserEmail">john.doe@email.com</p>
                            <span class="account-type-badge" id="sidebarAccountType">Regular Account</span>
                        </div>
                    </div>
                    <div class="quick-actions">
                        <a href="#" class="quick-action-btn my-profile-link">
                            <i class="fas fa-user"></i>
                            <span>Profile</span>
                        </a>
                        <a href="wishlist.html" class="quick-action-btn" id="sidebarWishlistBtn">
                            <i class="fas fa-heart"></i>
                            <span>Wishlist</span>
                            <span class="quick-action-badge" id="sidebarWishlistBadge" style="display: none;">0</span>
                        </a>
                        <a href="#" class="quick-action-btn" id="mobileMessagesLink">
                            <i class="fas fa-comments"></i>
                            <span>Messages</span>
                            <span class="quick-action-badge" id="sidebarMessagesBadge" style="display: none;">0</span>
                        </a>
                        <a href="price-alerts.html" class="quick-action-btn" id="sidebarPriceAlertsBtn">
                            <i class="fas fa-tag"></i>
                            <span>Alerts</span>
                            <span class="quick-action-badge" id="sidebarPriceAlertsBadge"
                                style="display: none;">0</span>
                        </a>
                        <a href="notifications.html" class="quick-action-btn" id="sidebarNotificationsBtn">
                            <i class="fas fa-bell"></i>
                            <span>Notifications</span>
                            <span class="quick-action-badge" id="sidebarNotificationsBadge"
                                style="display: none;">0</span>
                        </a>
                        <a href="local_hub.html" class="quick-action-btn">
                            <i class="fas fa-store"></i>
                            <span>LocalHub</span>
                        </a>
                        <a href="FAQs.html" class="quick-action-btn">
                            <i class="fas fa-question-circle"></i>
                            <span>Help</span>
                        </a>
                        <a href="about-us.html" class="quick-action-btn">
                            <i class="fas fa-info-circle"></i>
                            <span>About Us</span>
                        </a>
                        <a href="#" class="quick-action-btn" onclick="showLogoutConfirmation(); return false;">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Visual Separator -->
            <div class="mx-3 my-3">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1"
                        style="height: 2px; background: linear-gradient(to right, rgba(0,0,0,0.1), rgba(0,0,0,0.3), rgba(0,0,0,0.1));">
                    </div>
                    <div class="mx-2">
                        <i class="fas fa-circle" style="font-size: 8px; color: rgba(220, 53, 69, 0.8);"></i>
                    </div>
                    <div class="flex-grow-1"
                        style="height: 2px; background: linear-gradient(to left, rgba(0,0,0,0.1), rgba(0,0,0,0.3), rgba(0,0,0,0.1));">
                    </div>
                </div>
            </div>

            <div class="sidebar-section custom-categories-section">
                <h4>Categories</h4>
                <div class="custom-category-search">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search categories..." class="custom-category-input"
                        id="categorySearchInput">
                </div>
                <div class="custom-category-list">
                    <div class="custom-category-item" data-category="smartphones-tablets">
                        <div class="custom-category-header" onclick="toggleCustomCategory(this)">
                            <div class="custom-category-icon">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <span class="custom-category-title">Smartphones and Tablets</span>
                            <i class="fas fa-chevron-down custom-category-chevron"></i>
                        </div>
                        <div class="custom-category-dropdown">
                            <a href="smartphones.html" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Smartphones</span>
                            </a>
                            <a href="tablets.html" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Tablets</span>
                            </a>
                            <a href="#accessories" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Mobile Accessories</span>
                            </a>
                        </div>
                    </div>

                    <div class="custom-category-item" data-category="wearables">
                        <div class="custom-category-header" onclick="toggleCustomCategory(this)">
                            <div class="custom-category-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <span class="custom-category-title">Wearables Devices</span>
                            <i class="fas fa-chevron-down custom-category-chevron"></i>
                        </div>
                        <div class="custom-category-dropdown">
                            <a href="#smartwatches" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Smartwatches</span>
                            </a>
                            <a href="#fitness-trackers" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Fitness Trackers</span>
                            </a>
                        </div>
                    </div>

                    <div class="custom-category-item" data-category="laptops-accessories">
                        <div class="custom-category-header" onclick="toggleCustomCategory(this)">
                            <div class="custom-category-icon">
                                <i class="fas fa-laptop"></i>
                            </div>
                            <span class="custom-category-title">Laptops and Accessories</span>
                            <i class="fas fa-chevron-down custom-category-chevron"></i>
                        </div>
                        <div class="custom-category-dropdown">
                            <a href="#laptops" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Windows Laptops</span>
                            </a>
                            <a href="#desktops" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Macbooks</span>
                            </a>
                            <a href="#monitors" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Chromebooks</span>
                            </a>
                            <a href="#keyboards" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Accessories</span>
                            </a>
                        </div>
                    </div>

                    <div class="custom-category-item" data-category="televisions">
                        <div class="custom-category-header" onclick="toggleCustomCategory(this)">
                            <div class="custom-category-icon">
                                <i class="fas fa-tv"></i>
                            </div>
                            <span class="custom-category-title">Televisions & Streaming</span>
                            <i class="fas fa-chevron-down custom-category-chevron"></i>
                        </div>
                        <div class="custom-category-dropdown">
                            <a href="#televisions" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Televisions</span>
                            </a>
                            <a href="#streaming" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Streaming Devices</span>
                            </a>
                        </div>
                    </div>

                    <div class="custom-category-item" data-category="audio">
                        <div class="custom-category-header" onclick="toggleCustomCategory(this)">
                            <div class="custom-category-icon">
                                <i class="fas fa-headphones"></i>
                            </div>
                            <span class="custom-category-title">Audio</span>
                            <i class="fas fa-chevron-down custom-category-chevron"></i>
                        </div>
                        <div class="custom-category-dropdown">
                            <a href="#earbuds" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Earbuds</span>
                            </a>
                            <a href="#headphones" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Headphones</span>
                            </a>
                            <a href="#speakers" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Bluetooth Speakers</span>
                            </a>
                            <a href="#party-speakers" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Party Speakers</span>
                            </a>
                            <a href="#soundbars" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Soundbars</span>
                            </a>
                            <a href="#hifi" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Hi-fi Systems</span>
                            </a>
                        </div>
                    </div>

                    <div class="custom-category-item" data-category="gaming">
                        <div class="custom-category-header" onclick="toggleCustomCategory(this)">
                            <div class="custom-category-icon">
                                <i class="fas fa-gamepad"></i>
                            </div>
                            <span class="custom-category-title">Gaming</span>
                            <i class="fas fa-chevron-down custom-category-chevron"></i>
                        </div>
                        <div class="custom-category-dropdown">
                            <a href="#consoles" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Gaming Consoles</span>
                            </a>
                            <a href="#controllers" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Controllers</span>
                            </a>
                            <a href="#gaming-accessories" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Gaming Accessories</span>
                            </a>
                        </div>
                    </div>

                    <div class="custom-category-item" data-category="appliances">
                        <div class="custom-category-header" onclick="toggleCustomCategory(this)">
                            <div class="custom-category-icon">
                                <i class="fas fa-blender"></i>
                            </div>
                            <span class="custom-category-title">Appliances</span>
                            <i class="fas fa-chevron-down custom-category-chevron"></i>
                        </div>
                        <div class="custom-category-dropdown">
                            <div class="custom-category-link has-nested" onclick="toggleNestedSubcategory(this)">
                                <i class="fas fa-circle"></i>
                                <span>Fridges & Freezers</span>
                                <i class="fas fa-chevron-down nested-chevron"></i>
                            </div>
                            <div class="nested-subcategory-dropdown">
                                <a href="#fridges" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Fridges</span>
                                </a>
                                <a href="#freezers" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Freezers</span>
                                </a>
                            </div>
                            <div class="custom-category-link has-nested" onclick="toggleNestedSubcategory(this)">
                                <i class="fas fa-circle"></i>
                                <span>Microwaves, Ovens & Stoves</span>
                                <i class="fas fa-chevron-down nested-chevron"></i>
                            </div>
                            <div class="nested-subcategory-dropdown">
                                <a href="#microwaves" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Microwaves</span>
                                </a>
                                <a href="#ovens" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Ovens</span>
                                </a>
                                <a href="#stoves" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Stoves</span>
                                </a>
                            </div>
                            <a href="#kettles-coffee-machines" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Kettles, Coffee Machines</span>
                            </a>
                            <a href="#floorcare" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Floorcare</span>
                            </a>
                            <a href="#food-preparation" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Food Preparation</span>
                            </a>
                            <a href="#heaters-electric-blankets" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Heaters & Electric Blankets</span>
                            </a>
                            <a href="#personal-care" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Personal Care</span>
                            </a>
                            <div class="custom-category-link has-nested" onclick="toggleNestedSubcategory(this)">
                                <i class="fas fa-circle"></i>
                                <span>Cookers & Air Fryers</span>
                                <i class="fas fa-chevron-down nested-chevron"></i>
                            </div>
                            <div class="nested-subcategory-dropdown">
                                <a href="#cookers" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Cookers</span>
                                </a>
                                <a href="#air-fryers" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Air Fryers</span>
                                </a>
                            </div>
                            <div class="custom-category-link has-nested" onclick="toggleNestedSubcategory(this)">
                                <i class="fas fa-circle"></i>
                                <span>Toasters & Sandwich Makers</span>
                                <i class="fas fa-chevron-down nested-chevron"></i>
                            </div>
                            <div class="nested-subcategory-dropdown">
                                <a href="#toasters" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Toasters</span>
                                </a>
                                <a href="#sandwich-makers" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Sandwich Makers</span>
                                </a>
                            </div>
                            <a href="#dishwashers" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Dishwashers</span>
                            </a>
                            <div class="custom-category-link has-nested" onclick="toggleNestedSubcategory(this)">
                                <i class="fas fa-circle"></i>
                                <span>Irons & Steamers</span>
                                <i class="fas fa-chevron-down nested-chevron"></i>
                            </div>
                            <div class="nested-subcategory-dropdown">
                                <a href="#irons" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Irons</span>
                                </a>
                                <a href="#steamers" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Steamers</span>
                                </a>
                            </div>
                            <a href="#sewing-machine" class="custom-category-link">
                                <i class="fas fa-circle"></i>
                                <span>Sewing Machine</span>
                            </a>
                            <div class="custom-category-link has-nested" onclick="toggleNestedSubcategory(this)">
                                <i class="fas fa-circle"></i>
                                <span>Humidifiers & Purifiers</span>
                                <i class="fas fa-chevron-down nested-chevron"></i>
                            </div>
                            <div class="nested-subcategory-dropdown">
                                <a href="#humidifiers" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Humidifiers</span>
                                </a>
                                <a href="#purifiers" class="nested-subcategory-link">
                                    <i class="fas fa-circle"></i>
                                    <span>Purifiers</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>




    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Toast Container for Notifications -->
    <div class="toast-container position-fixed" style="top: 80px; right: 20px; z-index: 9999;" id="toastContainer">
    </div>

    <main class="main">
        <!-- HERO DESIGN 3 SECTION -->
        <div class="hero-d3-wrapper">
            <div class="hero-d3">
                <div class="icon"><i class="fas fa-chart-line"></i></div>
                <div>
                    <h1>Business Analytics Overview</h1>
                    <p>Comprehensive insights into your business performance</p>
                </div>
                <div class="hero-actions">
                    <button class="hero-btn" onclick="exportToPDF()" id="exportPdfBtn">
                        Export PDF <i class="fas fa-chevron-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="business-analytics-container">
            <!-- Breadcrumb Navigation -->
            <div class="breadcrumb-container">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb" style="background: transparent; padding: 0; margin: 0; font-size: 0.9rem;">
                        <li class="breadcrumb-item"><a href="index.html"
                                style="color: #6c757d; text-decoration: none;">Home</a></li>
                        <li class="breadcrumb-item"><a href="business_management.html"
                                style="color: #6c757d; text-decoration: none;">Business Management</a></li>
                        <li class="breadcrumb-item active" aria-current="page" style="color: #6c757d;">Analytics</li>
                    </ol>
                </nav>
            </div>





            <!-- Stats Overview (CSS Rings Design) -->
            <div class="stats-grid-rings">
                <div class="css-ring-container">
                    <!-- Total Followers -->
                    <div class="css-ring-wrapper">
                        <div class="css-ring" style="--p: 100; --fill-color: #3b82f6;">
                            <span id="totalFollowersRing">0</span>
                        </div>
                        <div class="ring-label">Total Followers</div>
                    </div>

                    <!-- Total Reviews -->
                    <div class="css-ring-wrapper">
                        <div class="css-ring" style="--p: 100; --fill-color: #10b981;">
                            <span id="totalReviewsRing">0</span>
                        </div>
                        <div class="ring-label">Total Reviews</div>
                    </div>

                    <!-- Avg Rating -->
                    <div class="css-ring-wrapper">
                        <div class="css-ring" style="--p: 90; --fill-color: #f59e0b;">
                            <span id="averageRatingRing">0.0</span>
                        </div>
                        <div class="ring-label">Avg Rating</div>
                    </div>

                    <!-- Total Likes -->
                    <div class="css-ring-wrapper">
                        <div class="css-ring" style="--p: 75; --fill-color: #ef4444;">
                            <span id="totalProductLikesRing">0</span>
                        </div>
                        <div class="ring-label">Total Likes</div>
                    </div>

                    <!-- New Followers (Month) -->
                    <div class="css-ring-wrapper">
                        <div class="css-ring" style="--p: 45; --fill-color: #06b6d4;">
                            <span id="newFollowersRing">0</span>
                        </div>
                        <div class="ring-label">New Followers</div>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="row mb-4">
                <!-- Followers Growth Chart (Premium Design 1 - Smooth Line) -->
                <div class="col-lg-6">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-chart-area text-primary"></i> Followers Growth
                            </h3>
                        </div>
                        <div class="canvas-container">
                            <canvas id="followersChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Rating Distribution Chart (Premium Design 2 - Slender Doughnut) -->
                <div class="col-lg-6">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-chart-pie text-warning"></i> Rating Distribution
                            </h3>
                        </div>
                        <div class="canvas-container" style="height: 300px; position: relative;">
                            <canvas id="ratingDistributionChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reviews Over Time Chart (Premium Design 3 - Vertical Bar) -->
            <div class="row mb-4">
                <!-- Reviews Over Time Chart (Premium Design 3 - Vertical Bar) -->
                <div class="col-lg-6">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-chart-bar text-success"></i> Reviews Over Time
                            </h3>
                        </div>
                        <div class="canvas-container">
                            <canvas id="reviewsOverTimeChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Product Likes Over Time Chart (Premium Design 27 - Luminous Line) -->
                <div class="col-lg-6">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-heart text-danger"></i> Product Likes Over Time (Luminous)
                            </h3>
                            <span class="design-badge"></span>
                        </div>
                        <div class="canvas-container">
                            <canvas id="productLikesChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Tables Row -->
            <div class="row">
                <!-- Recent Followers -->
                <div class="col-lg-6">
                    <div class="table-section">
                        <h3><i class="fas fa-users"></i> Recent Followers</h3>
                        <!-- Recent Followers (Design 41 Modified) -->
                        <div class="canvas-container" style="height: auto; min-height: 250px; overflow-y: auto;"
                            id="recentFollowersList">
                            <div class="d-flex justify-content-center align-items-center h-100"
                                style="min-height: 200px;">
                                <div class="text-muted">Loading...</div>
                            </div>
                            <!-- Fallback for loading state or empty -->
                        </div>
                    </div>
                </div>

                <!-- Recent Reviews -->
                <div class="col-lg-6">
                    <div class="table-section">
                        <h3><i class="fas fa-star"></i> Recent Reviews</h3>
                        <!-- Recent Reviews (Design 48 Compact Star List) -->
                        <div class="canvas-container" style="height: auto; min-height: 250px;" id="recentReviewsList">
                            <div class="d-flex justify-content-center align-items-center h-100"
                                style="min-height: 200px;">
                                <div class="text-muted">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Most Liked Products (Design 51: Leaderboard) -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-heart text-danger"></i> Most Liked Products - Leaderboard
                            </h3>
                            <span class="design-badge"></span>
                        </div>
                        <div class="canvas-container" style="height: auto; min-height: 250px; overflow-y: auto;"
                            id="mostLikedProductsList">
                            <div class="d-flex justify-content-center align-items-center h-100"
                                style="min-height: 200px;">
                                <div class="text-muted">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rating Breakdown Table -->
            <!-- Rating Breakdown (Design 36: Linear Progress Stack) -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-chart-bar"></i> Rating Breakdown
                            </h3>
                            <span class="design-badge"></span>
                        </div>
                        <div class="canvas-container" style="height: auto; min-height: 250px; padding: 1rem 0;"
                            id="ratingBreakdownList">
                            <div class="d-flex justify-content-center align-items-center h-100"
                                style="min-height: 200px;">
                                <div class="text-muted">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>About CompareHubPrices</h3>
                <ul>
                    <li><a href="about-us.html">About Us</a></li>
                    <li><a href="articles.html">Blog</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Help & Support</h3>
                <ul>
                    <li><a href="contact-us.html">Contact Us</a></li>
                    <li><a href="FAQs.html">FAQs</a></li>
                    <li><a href="privacy-policy.html">Privacy Policy</a></li>
                    <li><a href="Terms-of-Service.html">Terms of Service</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Connect With Us</h3>
                <div class="social-icons">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="#" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
                </div>
                <div class="newsletter-section">
                    <h4>Get the Best Deals in Your Inbox</h4>
                    <form class="newsletter-form" onsubmit="subscribeNewsletter(event)">
                        <input type="email" placeholder="Enter your email address" required
                            aria-label="Email address for newsletter">
                        <button type="submit"><i class="fas fa-paper-plane"></i> Subscribe</button>
                    </form>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 CompareHub Prices. All rights reserved.</p>
        </div>
    </footer>







    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="assets/scripts/device-detection.js"></script>
    <script src="assets/scripts/script.js"></script>
    <script src="assets/scripts/search.js"></script>
    <script src="assets/scripts/lazy_loading.js"></script>
    <script src="assets/scripts/sidebar-header.js"></script>
    <script src="assets/scripts/sidebar-mobile.js"></script>
    <script src="assets/scripts/badge-counter.js"></script>
    <script src="assets/scripts/notifications.js"></script>
    <script src="assets/scripts/aws-auth-business.js"></script>
    <script src="assets/scripts/chatbox.js"></script>
    <script src="assets/scripts/price-alerts.js"></script>
    <script src="assets/scripts/wishlist.js"></script>

    <script>
        const API_BASE_URL = 'https://hub.comparehubprices.co.za/business/business/analytics';
        let analyticsData = null;
        let charts = {};

        // Load analytics data
        async function loadAnalytics() {
            try {
                const response = await fetch(API_BASE_URL, {
                    method: 'GET',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                if (data.success && data.analytics) {
                    analyticsData = data.analytics;
                    updateStats();
                    updateCharts();
                    updateTables();
                } else {
                    console.error('Failed to load analytics:', data);
                }
            } catch (error) {
                console.error('Error loading analytics:', error);
            }
        }

        // Update stats cards (CSS Rings)
        function updateStats() {
            if (!analyticsData) return;

            // Helper to update text
            const setText = (id, text) => {
                const el = document.getElementById(id);
                if (el) el.textContent = text;
            };

            // Update Ring Progress (CSS Variable --p)
            const setRing = (id, percent) => {
                const el = document.getElementById(id);
                if (el && el.parentElement && el.parentElement.classList.contains('css-ring')) {
                    const safePercent = Math.min(Math.max(percent, 0), 100);
                    el.parentElement.style.setProperty('--p', safePercent);
                }
            };

            // 1. Total Followers
            const totalFollowers = analyticsData.totalFollowers || 0;
            setText('totalFollowersRing', totalFollowers.toLocaleString());
            setRing('totalFollowersRing', 100); // Always full for total

            // 2. Total Reviews
            const totalReviews = analyticsData.totalReviews || 0;
            setText('totalReviewsRing', totalReviews.toLocaleString());
            setRing('totalReviewsRing', 100); // Always full for total

            // 3. Avg Rating
            const avgRating = parseFloat(analyticsData.averageRating) || 0;
            setText('averageRatingRing', avgRating.toFixed(1));
            setRing('averageRatingRing', (avgRating / 5) * 100);

            // 4. Total Likes
            const totalLikes = analyticsData.totalLikes || 0;
            setText('totalProductLikesRing', totalLikes.toLocaleString());
            setRing('totalProductLikesRing', 75); // Visual preference or calc if goal exists

            // 5. New Followers
            const newFollowers = analyticsData.followersGained || 0;
            setText('newFollowersRing', newFollowers.toLocaleString());
            // Calculate percentage of total if possible, else visual default
            const newFollowerPercent = totalFollowers > 0 ? (newFollowers / totalFollowers) * 100 : 0;
            // Cap visual at 100 even if high growth, or maybe scale it up for visibility
            // For now, let's use the actual ratio or a minimum visual
            setRing('newFollowersRing', Math.max(newFollowerPercent, 5));
        }

        // Update charts
        function updateCharts() {
            if (!analyticsData) return;

            // --- Followers Growth Chart (Design 1: Smooth Line) ---
            const followersCtx = document.getElementById('followersChart');
            if (followersCtx && !charts.followers) {
                // Calculate cumulative followers
                let cumulative = 0;
                const cumulativeData = analyticsData.followersByMonth.data.map(count => {
                    cumulative += count;
                    return cumulative;
                });

                const ctxContext = followersCtx.getContext('2d');
                // Design 1 Gradient
                const gradient = ctxContext.createLinearGradient(0, 0, 0, 300);
                gradient.addColorStop(0, 'rgba(37, 99, 235, 0.5)'); // Blue
                gradient.addColorStop(1, 'rgba(37, 99, 235, 0.0)');

                charts.followers = new Chart(ctxContext, {
                    type: 'line',
                    data: {
                        labels: analyticsData.followersByMonth.labels,
                        datasets: [{
                            label: 'Total Followers',
                            data: cumulativeData,
                            borderColor: '#3b82f6',
                            backgroundColor: gradient,
                            borderWidth: 3,
                            tension: 0.4, // Smooth curve
                            fill: true,
                            pointBackgroundColor: '#2563eb',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: { intersect: false, mode: 'index' }
                        },
                        scales: {
                            y: {
                                beginAtZero: false,
                                grid: { borderDash: [5, 5], color: 'rgba(0,0,0,0.05)' }
                            },
                            x: {
                                grid: { display: false }
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                });
            }

            // --- Rating Distribution (Design 36 HTML) ---
            // --- Rating Distribution (Design 2: Slender Doughnut) ---
            const ratingDistCanvas = document.getElementById('ratingDistributionChart');
            if (ratingDistCanvas && analyticsData.ratingDistribution && !charts.ratingDist) {
                const total = analyticsData.totalReviews;
                const ratingsData = [5, 4, 3, 2, 1].map(r => analyticsData.ratingDistribution[r] || 0);

                const ctx2 = ratingDistCanvas.getContext('2d');
                charts.ratingDist = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['5 Stars', '4 Stars', '3 Stars', '2 Stars', '1 Star'],
                        datasets: [{
                            data: ratingsData,
                            backgroundColor: [
                                '#10b981', // green
                                '#3b82f6', // blue
                                '#f59e0b', // amber
                                '#f97316', // orange
                                '#ef4444'  // red
                            ],
                            borderWidth: 0,
                            hoverOffset: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '75%', // Thinner ring
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    usePointStyle: true,
                                    boxWidth: 6,
                                    padding: 20,
                                    color: '#64748b' // Slate color for text
                                }
                            }
                        }
                    }
                });
            }

            // --- Reviews Over Time Chart (Design 3: Vertical Bar) ---
            const reviewsCtx = document.getElementById('reviewsOverTimeChart');
            if (reviewsCtx && !charts.reviews) {
                const ctxContext = reviewsCtx.getContext('2d');
                // Design 3 Gradient
                const gradient = ctxContext.createLinearGradient(0, 0, 0, 300);
                gradient.addColorStop(0, '#8b5cf6'); // Purple
                gradient.addColorStop(1, '#6366f1'); // Indigo

                charts.reviews = new Chart(ctxContext, {
                    type: 'bar',
                    data: {
                        labels: analyticsData.reviewsByMonth.labels,
                        datasets: [{
                            label: 'Reviews',
                            data: analyticsData.reviewsByMonth.data,
                            backgroundColor: gradient,
                            borderRadius: 8, // Rounded bars
                            borderSkipped: false,
                            barPercentage: 0.6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(0,0,0,0.05)' }
                            },
                            x: {
                                grid: { display: false }
                            }
                        }
                    }
                });
            }

            // Product Likes Over Time Chart (Premium Design 27 - Luminous Line)
            const productLikesCtx = document.getElementById('productLikesChart');
            if (productLikesCtx && !charts.productLikes && analyticsData.likesByMonth) {
                const ctx27 = productLikesCtx.getContext('2d');
                const grad27 = ctx27.createLinearGradient(0, 0, 400, 0);
                grad27.addColorStop(0, '#22d3ee'); // Cyan
                grad27.addColorStop(1, '#818cf8'); // Indigo

                Chart.defaults.elements.line.borderCapStyle = 'round';

                charts.productLikes = new Chart(ctx27, {
                    type: 'line',
                    data: {
                        labels: analyticsData.likesByMonth.labels,
                        datasets: [
                            {
                                label: 'Total Product Likes',
                                data: analyticsData.likesByMonth.data,
                                borderColor: '#22d3ee', // Cyan border
                                backgroundColor: 'rgba(34, 211, 238, 0.1)', // Subtle fill
                                borderWidth: 4,
                                tension: 0.4,
                                pointBackgroundColor: '#fff',
                                pointBorderColor: '#22d3ee',
                                pointBorderWidth: 3,
                                pointRadius: 6,
                                pointHoverRadius: 9,
                                fill: true,
                                order: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                intersect: false,
                                mode: 'index',
                                backgroundColor: 'rgba(30, 41, 59, 0.9)', // Dark slate tooltip
                                titleColor: '#fff',
                                bodyColor: '#cbd5e1',
                                borderColor: '#334155',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: false,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)', // Keep light for this page theme
                                    borderDash: [5, 5]
                                }
                            },
                            x: {
                                grid: { display: false }
                            }
                        }
                    }
                });
            }
        }

        // Update tables (Now Lists)
        function updateTables() {
            if (!analyticsData) return;

            // Update Recent Followers List
            const followersList = document.getElementById('recentFollowersList');
            if (followersList) {
                if (!analyticsData.recentFollowers || analyticsData.recentFollowers.length === 0) {
                    followersList.innerHTML = '<div class="d-flex justify-content-center align-items-center h-100"><div class="text-muted">No followers yet</div></div>';
                } else {
                    followersList.innerHTML = analyticsData.recentFollowers.map(follower => {
                        const date = new Date(follower.followedAt); // or however date is passed
                        const initials = (follower.followerName || 'U').split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                        // Colors for avatars
                        const colors = ['#3b82f6', '#10b981', '#f59e0b', '#ec4899', '#8b5cf6'];
                        const color = colors[Math.floor(Math.random() * colors.length)];

                        return `
                            <div class="follower-item">
                                <div class="follower-avatar" style="background: ${color};">
                                    <span>${initials}</span>
                                </div>
                                <div class="follower-info">
                                    <div class="follower-name">${follower.followerName || 'Unknown'}</div>
                                    <div class="follower-meta">Started following ${formatDate(date)}</div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            }

            // Update Most Liked Products List
            const mostLikedList = document.getElementById('mostLikedProductsList');
            if (mostLikedList && analyticsData.mostLikedProducts) {
                if (analyticsData.mostLikedProducts.length === 0) {
                    mostLikedList.innerHTML = '<div class="d-flex justify-content-center align-items-center h-100"><div class="text-muted">No products yet</div></div>';
                } else {
                    // Sort primarily by Rank if available, or just use array order
                    mostLikedList.innerHTML = analyticsData.mostLikedProducts.map(product => {
                        const trendVal = parseFloat(product.trend);
                        const isUp = trendVal >= 0;
                        const trendClass = isUp ? 'trend-up' : 'trend-down';
                        const trendIcon = isUp ? 'fa-arrow-up' : 'fa-arrow-down';

                        return `
                            <div class="leaderboard-item">
                                <div class="leaderboard-rank">#${product.rank}</div>
                                <div class="leaderboard-info">
                                    <div class="leaderboard-title">${product.productName}</div>
                                    <div class="leaderboard-meta">${product.category || 'Product'}</div> 
                                </div>
                                <div class="leaderboard-stats">
                                    <div class="leaderboard-likes">${product.totalLikes}</div>
                                    <div class="leaderboard-trend ${trendClass}">
                                        <i class="fas ${trendIcon}"></i> ${Math.abs(trendVal)}%
                                    </div>
                                </div>
                            </div>
                         `;
                    }).join('');
                }
            }

            // Update Recent Reviews List
            const reviewsList = document.getElementById('recentReviewsList');
            if (reviewsList) {
                if (!analyticsData.recentReviews || analyticsData.recentReviews.length === 0) {
                    reviewsList.innerHTML = '<div class="d-flex justify-content-center align-items-center h-100"><div class="text-muted">No reviews yet</div></div>';
                } else {
                    reviewsList.innerHTML = analyticsData.recentReviews.map(review => {
                        const scoreClass = review.rating >= 4 ? '' : (review.rating >= 3 ? 'avg' : 'bad');

                        return `
                            <div class="compact-review-row">
                                <div class="compact-review-left">
                                    <div class="compact-score-box ${scoreClass}">${review.rating.toFixed(1)}</div>
                                    <div class="compact-review-content">
                                        <h4>${review.reviewerName || 'Reviewer'}</h4>
                                        <p>${(review.comment || '').substring(0, 60)}${(review.comment || '').length > 60 ? '...' : ''}</p>
                                    </div>
                                </div>
                                <div style="color: var(--text); font-size: 0.8rem;">${formatDate(new Date(review.createdAt))}</div>
                            </div>
                        `;
                    }).join('');
                }
            }

            // Update Rating Breakdown (Detailed)
            const ratingBreakdownList = document.getElementById('ratingBreakdownList');
            if (ratingBreakdownList && analyticsData.ratingDistribution) {
                const total = analyticsData.totalReviews;
                const ratings = [5, 4, 3, 2, 1];
                ratingBreakdownList.innerHTML = ratings.map(rating => {
                    const count = analyticsData.ratingDistribution[rating] || 0;
                    const percentage = total > 0 ? ((count / total) * 100).toFixed(1) : '0.0';
                    let colorClass = '#ef4444';
                    if (rating === 5) colorClass = '#10b981';
                    if (rating === 4) colorClass = '#3b82f6';
                    if (rating === 3) colorClass = '#f59e0b';
                    if (rating === 2) colorClass = '#f97316';

                    return `
                        <div class="rating-row">
                            <div class="rating-label">${rating} <span class="text-warning">â˜…</span></div>
                            <div class="rating-bar-bg">
                                <div class="rating-bar-fill" style="width: ${percentage}%; background: ${colorClass};"></div>
                            </div>
                            <div class="rating-count"><strong>${count}</strong> (${percentage}%)</div>
                        </div>
                    `;
                }).join('');
            }
        }

        // Helper functions
        function formatDate(date) {
            const now = new Date();
            const diff = now - date;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));

            if (days === 0) return 'Today';
            if (days === 1) return 'Yesterday';
            if (days < 7) return `${days} days ago`;
            if (days < 30) return `${Math.floor(days / 7)} weeks ago`;
            if (days < 365) return `${Math.floor(days / 30)} months ago`;
            return `${Math.floor(days / 365)} years ago`;
        }

        function getProgressBarClass(rating) {
            if (rating >= 4) return 'bg-success';
            if (rating === 3) return 'bg-warning';
            return 'bg-danger';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function () {
            loadAnalytics();
        });

        // Export to PDF function
        async function exportToPDF() {
            const btn = document.getElementById('exportPdfBtn');
            const originalText = btn.innerHTML;

            try {
                // Disable button and show loading
                btn.disabled = true;
                btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating PDF...';

                // Try to get business information from session
                let businessInfo = {
                    businessName: 'Your Business',
                    ownerName: 'Business Owner',
                    businessAddress: 'Business Address'
                };

                try {
                    if (window.businessAWSAuthService) {
                        const userInfo = await window.businessAWSAuthService.getUserInfo();
                        if (userInfo && userInfo.success && userInfo.user) {
                            const user = userInfo.user;
                            businessInfo.businessName = user.businessName || user.business_name || 'Your Business';
                            const givenName = user.givenName || user.given_name || '';
                            const familyName = user.familyName || user.family_name || '';
                            businessInfo.ownerName = (givenName + ' ' + familyName).trim() || 'Business Owner';
                            businessInfo.businessAddress = user.businessAddress || user.business_address ||
                                (user.streetAddress ? `${user.streetAddress}${user.city ? ', ' + user.city : ''}${user.province ? ', ' + user.province : ''}${user.postalCode ? ' ' + user.postalCode : ''}` : 'Business Address');
                        }
                    }
                } catch (err) {
                    console.warn('Could not fetch business info:', err);
                }

                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 10;
                const contentWidth = pageWidth - (margin * 2);

                let yPosition = margin;

                // Create header with logo and title
                const headerDiv = document.createElement('div');
                headerDiv.style.position = 'absolute';
                headerDiv.style.left = '-9999px';
                headerDiv.style.width = '800px';
                headerDiv.style.padding = '20px';
                headerDiv.style.backgroundColor = '#ffffff';
                headerDiv.style.display = 'flex';
                headerDiv.style.flexDirection = 'column';
                headerDiv.style.gap = '15px';

                // Top row: Logo and title
                const topRow = document.createElement('div');
                topRow.style.display = 'flex';
                topRow.style.alignItems = 'center';
                topRow.style.gap = '15px';

                const logoImg = document.createElement('img');
                logoImg.src = 'assets/logo .png';
                logoImg.style.height = '50px';
                logoImg.style.width = 'auto';
                logoImg.style.objectFit = 'contain';

                const titleDiv = document.createElement('div');
                titleDiv.innerHTML = '<h1 style="margin: 0; font-size: 24px; font-weight: bold; color: #333;">Business Analytics Report</h1>';

                topRow.appendChild(logoImg);
                topRow.appendChild(titleDiv);

                // Business information section
                const businessInfoDiv = document.createElement('div');
                businessInfoDiv.style.borderTop = '2px solid #e0e0e0';
                businessInfoDiv.style.paddingTop = '15px';
                businessInfoDiv.style.display = 'flex';
                businessInfoDiv.style.flexDirection = 'column';
                businessInfoDiv.style.gap = '8px';
                businessInfoDiv.innerHTML = `
                    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px;">
                            <strong style="color: #666; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px;">Business Name</strong>
                            <p style="margin: 5px 0 0 0; font-size: 14px; color: #333; font-weight: 600;">${businessInfo.businessName}</p>
                        </div>
                        <div style="flex: 1; min-width: 200px;">
                            <strong style="color: #666; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px;">Business Owner</strong>
                            <p style="margin: 5px 0 0 0; font-size: 14px; color: #333; font-weight: 600;">${businessInfo.ownerName}</p>
                        </div>
                    </div>
                    <div>
                        <strong style="color: #666; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px;">Business Address</strong>
                        <p style="margin: 5px 0 0 0; font-size: 14px; color: #333;">${businessInfo.businessAddress}</p>
                    </div>
                `;

                headerDiv.appendChild(topRow);
                headerDiv.appendChild(businessInfoDiv);
                document.body.appendChild(headerDiv);

                // Wait for logo to load
                await new Promise((resolve) => {
                    if (logoImg.complete) {
                        resolve();
                    } else {
                        logoImg.onload = resolve;
                        logoImg.onerror = resolve; // Continue even if logo fails
                        setTimeout(resolve, 2000); // Timeout after 2 seconds
                    }
                });

                // Capture header
                const headerCanvas = await html2canvas(headerDiv, {
                    backgroundColor: '#ffffff',
                    scale: 2,
                    logging: false
                });
                const headerImg = headerCanvas.toDataURL('image/png');
                const headerHeight = (headerCanvas.height * contentWidth) / headerCanvas.width;

                pdf.addImage(headerImg, 'PNG', margin, yPosition, contentWidth, headerHeight);
                yPosition += headerHeight + 10;

                // Remove temporary header element
                document.body.removeChild(headerDiv);

                // Add date
                pdf.setFontSize(10);
                pdf.setFont('helvetica', 'normal');
                const date = new Date().toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                pdf.text(`Generated on: ${date}`, margin, yPosition);
                yPosition += 15;

                // Capture stats cards
                const statsSection = document.querySelector('.stats-grid-rings');
                if (statsSection) {
                    const statsCanvas = await html2canvas(statsSection, {
                        backgroundColor: null, // Transparent to keep card styling or white if needed
                        scale: 2
                    });
                    const statsImg = statsCanvas.toDataURL('image/png');
                    const statsHeight = (statsCanvas.height * contentWidth) / statsCanvas.width;

                    if (yPosition + statsHeight > pageHeight - margin) {
                        pdf.addPage();
                        yPosition = margin;
                    }

                    pdf.addImage(statsImg, 'PNG', margin, yPosition, contentWidth, statsHeight);
                    yPosition += statsHeight + 10;
                }

                // Capture all Charts and Tables Cards
                // We select all content cards to ensure everything is included
                const contentCards = document.querySelectorAll('.chart-card, .table-section');

                for (const card of contentCards) {
                    // Check if visible
                    if (card.offsetParent === null) continue;

                    const cardCanvas = await html2canvas(card, {
                        backgroundColor: '#ffffff', // Ensure white background for standard cards
                        scale: 2
                    });
                    const cardImg = cardCanvas.toDataURL('image/png');
                    const cardHeight = (cardCanvas.height * contentWidth) / cardCanvas.width;

                    // Check if we need a new page
                    if (yPosition + cardHeight > pageHeight - margin) {
                        pdf.addPage();
                        yPosition = margin;
                    }

                    pdf.addImage(cardImg, 'PNG', margin, yPosition, contentWidth, cardHeight);
                    yPosition += cardHeight + 10;
                }

                // Add copyright footer to all pages
                const totalPages = pdf.internal.pages.length - 1;
                for (let i = 1; i <= totalPages; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(8);
                    pdf.setFont('helvetica', 'normal');
                    pdf.setTextColor(128, 128, 128);
                    const footerText = 'Â© 2025 CompareHub Prices. All rights reserved.';
                    const textWidth = pdf.getTextWidth(footerText);
                    const xPosition = (pageWidth - textWidth) / 2;
                    pdf.text(footerText, xPosition, pageHeight - 5);
                }

                // Save PDF
                const fileName = `Business_Analytics_${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(fileName);

                // Show success message
                btn.innerHTML = '<i class="fas fa-check"></i> PDF Generated!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);

            } catch (error) {
                console.error('Error generating PDF:', error);
                btn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Error';
                alert('Error generating PDF. Please try again.');
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
            }
        }
    </script>








</body>

</html>