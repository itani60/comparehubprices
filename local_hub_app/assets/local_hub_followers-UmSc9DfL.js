import{r as i,j as e,c as V,R}from"./localHub-BbJY8JdF.js";import{g as k,d as U}from"./localHubInfoApi-WD11izJB.js";/* empty css                    */function _(a){var u,d;const l=String(a||"").trim().split(/\s+/).filter(Boolean);if(!l.length)return"U";const r=((u=l[0])==null?void 0:u[0])||"",c=l.length>1&&((d=l[l.length-1])==null?void 0:d[0])||"";return(r+c).toUpperCase()||"U"}function A(){try{const a=new URL("local_hub_info.html",window.location.href);return a.search=window.location.search,a.hash=window.location.hash,a.toString()}catch{return"local_hub_info.html"}}function E(a){const l=String(a||"").trim();if(!l)return"local_hub_info.html";try{const r=new URL("local_hub_info.html",window.location.href);return r.searchParams.set("business_id",l),r.toString()}catch{return`local_hub_info.html?business_id=${encodeURIComponent(l)}`}}function $(a){if(!a)return"Not set";const l=new Date(a);return Number.isNaN(l.getTime())?"Not set":l.toLocaleDateString(void 0,{year:"numeric",month:"short"})}function T(a){const l=String((a==null?void 0:a.suburb)||"").trim(),r=String((a==null?void 0:a.village)||"").trim();return l?{label:"Suburb",value:l}:r?{label:"Village",value:r}:{label:"Suburb/Village",value:"Not set"}}const L="/local_hub_app/images/verified-badge.svg";function I(){const a=k(),[l,r]=i.useState([]),[c,u]=i.useState(""),[d,C]=i.useState(0),[F,N]=i.useState(0),[x,j]=i.useState(!0),[p,v]=i.useState(!1),[w,g]=i.useState(""),[t,h]=i.useState(null),B=30,M=l.length<d,y=i.useMemo(()=>{const s=c.trim().toLowerCase();return s?l.filter(n=>{const o=String(n.name||"").toLowerCase(),f=String(n.type||"").toLowerCase();return o.includes(s)||f.includes(s)}):l},[l,c]),m=i.useMemo(()=>a?x?"Loading followers...":l.length?"":"No followers yet.":"Missing business_id.",[a,x,l.length]);async function S({append:s}={}){if(a){s?v(!0):j(!0),g("");try{const n=await U({businessId:a,limit:B,offset:s?F:0}),o=Array.isArray(n==null?void 0:n.followers)?n.followers:[],f=Number(n==null?void 0:n.total)||0;s?(r(b=>[...b,...o]),N(b=>b+o.length)):(r(o),N(o.length)),C(f)}catch(n){g(n instanceof Error?n.message:"Failed to load followers.")}finally{j(!1),v(!1)}}}return i.useEffect(()=>{S({append:!1})},[a]),e.jsxs("div",{className:"page",children:[e.jsx("div",{className:"frame",children:e.jsxs("section",{className:"collCard followersCard",children:[e.jsxs("div",{className:"followersHeader",children:[e.jsxs("button",{className:"followersBack",type:"button",onClick:()=>window.location.href=A(),children:[e.jsx("i",{className:"fas fa-arrow-left"})," Back"]}),e.jsx("div",{className:"followersTitle",children:"Followers"}),e.jsx("div",{className:"followersCount",children:d})]}),e.jsxs("div",{className:"followersSearch",children:[e.jsx("i",{className:"fas fa-search"}),e.jsx("input",{type:"search",placeholder:"Search followers...",value:c,onChange:s=>u(s.target.value),"aria-label":"Search followers"})]}),w?e.jsx("div",{className:"followersError",children:w}):null,m?e.jsx("div",{className:"followersEmpty",children:m}):null,m?null:e.jsx("div",{className:"followersList",children:y.map(s=>e.jsxs("div",{className:"followerRow",children:[e.jsx("button",{type:"button",className:`followerAvatar ${s.type==="business"?"isBusiness":""}`,onClick:()=>h(s),"aria-label":`View ${s.name||"follower"} details`,children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.name||"Follower"}):_(s.name)}),e.jsxs("div",{className:"followerInfo",children:[e.jsxs("div",{className:"followerName",children:[s.name||"Follower",s.type==="business"&&s.is_verified?e.jsx("img",{src:L,alt:"Verified",className:"verified-badge",title:"Verified business","aria-label":"Verified business"}):null]}),e.jsx("div",{className:"followerMeta",children:e.jsx("span",{className:"followerBadge",children:s.type==="business"?"Business":"Standard"})})]})]},`${s.type}-${s.id}`))}),!m&&!y.length?e.jsx("div",{className:"followersEmpty",children:"No matches found."}):null,M?e.jsx("button",{type:"button",className:"followersLoad",onClick:()=>S({append:!0}),disabled:p,children:p?"Loading...":"Load more"}):null]})}),t?e.jsx("div",{className:"followersModalOverlay",onClick:()=>h(null),children:e.jsxs("div",{className:"followersModal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"followersModalHeader",children:[e.jsx("div",{className:"followersModalTitle",children:"Follower Details"}),e.jsx("button",{className:"followersModalClose",type:"button",onClick:()=>h(null),children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"followersModalBody",children:[e.jsx("div",{className:`modalAvatar ${t.type==="business"?"isBusiness":""}`,children:t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:t.name||"Follower"}):_(t.name)}),e.jsxs("div",{className:"modalName",children:[t.type==="business"?e.jsx("button",{type:"button",className:"modalNameButton",onClick:()=>{t.has_post&&(window.location.href=E(t.id))},disabled:!t.has_post,"aria-label":`View ${t.name||"business"} profile`,children:t.name||"Follower"}):e.jsx("span",{children:t.name||"Follower"}),t.type==="business"&&t.is_verified?e.jsx("img",{src:L,alt:"Verified",className:"verified-badge",title:"Verified business","aria-label":"Verified business"}):null]}),e.jsx("div",{className:"modalType",children:t.type==="business"?"Business Account":"Standard Account"}),e.jsxs("div",{className:"modalGrid",children:[(()=>{const s=T(t);return e.jsxs("div",{className:"modalRow",children:[e.jsx("span",{className:"modalLabel",children:s.label}),e.jsx("span",{className:"modalValue",children:s.value})]})})(),e.jsxs("div",{className:"modalRow",children:[e.jsx("span",{className:"modalLabel",children:"Province"}),e.jsx("span",{className:"modalValue",children:t.province||"Not set"})]}),e.jsxs("div",{className:"modalRow",children:[e.jsx("span",{className:"modalLabel",children:"Town"}),e.jsx("span",{className:"modalValue",children:t.town||"Not set"})]}),e.jsxs("div",{className:"modalRow",children:[e.jsx("span",{className:"modalLabel",children:"Account Since"}),e.jsx("span",{className:"modalValue",children:$(t.account_since)})]})]})]})]})}):null]})}V.createRoot(document.getElementById("root")).render(e.jsx(R.StrictMode,{children:e.jsx(I,{})}));
