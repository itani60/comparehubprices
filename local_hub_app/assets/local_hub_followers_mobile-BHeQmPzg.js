import{r as n,j as e,c as V,R}from"./localHub-BbJY8JdF.js";import{g as U,d as k}from"./localHubInfoApi-WD11izJB.js";/* empty css                   */function S(l){var u,d;const a=String(l||"").trim().split(/\s+/).filter(Boolean);if(!a.length)return"U";const o=((u=a[0])==null?void 0:u[0])||"",c=a.length>1&&((d=a[a.length-1])==null?void 0:d[0])||"";return(o+c).toUpperCase()||"U"}function A(){try{const l=new URL("local_hub_info_mobile.html",window.location.href);return l.search=window.location.search,l.hash=window.location.hash,l.toString()}catch{return"local_hub_info_mobile.html"}}function E(l){const a=String(l||"").trim();if(!a)return"local_hub_info_mobile.html";try{const o=new URL("local_hub_info_mobile.html",window.location.href);return o.searchParams.set("business_id",a),o.toString()}catch{return`local_hub_info_mobile.html?business_id=${encodeURIComponent(a)}`}}function $(l){if(!l)return"Not set";const a=new Date(l);return Number.isNaN(a.getTime())?"Not set":a.toLocaleDateString(void 0,{year:"numeric",month:"short"})}function T(l){const a=String((l==null?void 0:l.suburb)||"").trim(),o=String((l==null?void 0:l.village)||"").trim();return a?{label:"Suburb",value:a}:o?{label:"Village",value:o}:{label:"Suburb/Village",value:"Not set"}}const L="/local_hub_app/images/verified-badge.svg";function I(){const l=U(),[a,o]=n.useState([]),[c,u]=n.useState(""),[d,F]=n.useState(0),[C,N]=n.useState(0),[x,j]=n.useState(!0),[w,p]=n.useState(!1),[v,g]=n.useState(""),[t,h]=n.useState(null),M=24,B=a.length<d,y=n.useMemo(()=>{const s=c.trim().toLowerCase();return s?a.filter(i=>{const r=String(i.name||"").toLowerCase(),f=String(i.type||"").toLowerCase();return r.includes(s)||f.includes(s)}):a},[a,c]),m=n.useMemo(()=>l?x?"Loading followers...":a.length?"":"No followers yet.":"Missing business_id.",[l,x,a.length]);async function _({append:s}={}){if(l){s?p(!0):j(!0),g("");try{const i=await k({businessId:l,limit:M,offset:s?C:0}),r=Array.isArray(i==null?void 0:i.followers)?i.followers:[],f=Number(i==null?void 0:i.total)||0;s?(o(b=>[...b,...r]),N(b=>b+r.length)):(o(r),N(r.length)),F(f)}catch(i){g(i instanceof Error?i.message:"Failed to load followers.")}finally{j(!1),p(!1)}}}return n.useEffect(()=>{_({append:!1})},[l]),e.jsxs("div",{className:"screen",children:[e.jsxs("section",{className:"card followersCard",children:[e.jsxs("div",{className:"followersHeader",children:[e.jsxs("button",{className:"followersBack",type:"button",onClick:()=>window.location.href=A(),children:[e.jsx("i",{className:"fas fa-arrow-left"})," Back"]}),e.jsx("div",{className:"followersTitle",children:"Followers"}),e.jsx("div",{className:"followersCount",children:d})]}),e.jsxs("div",{className:"followersSearch",children:[e.jsx("i",{className:"fas fa-search"}),e.jsx("input",{type:"search",placeholder:"Search followers...",value:c,onChange:s=>u(s.target.value),"aria-label":"Search followers"})]}),v?e.jsx("div",{className:"followersError",children:v}):null,m?e.jsx("div",{className:"followersEmpty",children:m}):null,m?null:e.jsx("div",{className:"followersList",children:y.map(s=>e.jsxs("div",{className:"followerRow",children:[e.jsx("button",{type:"button",className:`followerAvatar ${s.type==="business"?"isBusiness":""}`,onClick:()=>h(s),"aria-label":`View ${s.name||"follower"} details`,children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.name||"Follower"}):S(s.name)}),e.jsxs("div",{className:"followerInfo",children:[e.jsxs("div",{className:"followerName",children:[s.name||"Follower",s.type==="business"&&s.is_verified?e.jsx("img",{src:L,alt:"Verified",className:"verified-badge",title:"Verified business","aria-label":"Verified business"}):null]}),e.jsx("div",{className:"followerMeta",children:e.jsx("span",{className:"followerBadge",children:s.type==="business"?"Business":"Standard"})})]})]},`${s.type}-${s.id}`))}),!m&&!y.length?e.jsx("div",{className:"followersEmpty",children:"No matches found."}):null,B?e.jsx("button",{type:"button",className:"followersLoad",onClick:()=>_({append:!0}),disabled:w,children:w?"Loading...":"Load more"}):null]}),t?e.jsx("div",{className:"followersModalOverlay",onClick:()=>h(null),children:e.jsxs("div",{className:"followersModal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"followersModalHeader",children:[e.jsx("div",{className:"followersModalTitle",children:"Follower Details"}),e.jsx("button",{className:"followersModalClose",type:"button",onClick:()=>h(null),children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"followersModalBody",children:[e.jsx("div",{className:`modalAvatar ${t.type==="business"?"isBusiness":""}`,children:t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:t.name||"Follower"}):S(t.name)}),e.jsxs("div",{className:"modalName",children:[t.type==="business"?e.jsx("button",{type:"button",className:"modalNameButton",onClick:()=>{t.has_post&&(window.location.href=E(t.id))},disabled:!t.has_post,"aria-label":`View ${t.name||"business"} profile`,children:t.name||"Follower"}):e.jsx("span",{children:t.name||"Follower"}),t.type==="business"&&t.is_verified?e.jsx("img",{src:L,alt:"Verified",className:"verified-badge",title:"Verified business","aria-label":"Verified business"}):null]}),e.jsx("div",{className:"modalType",children:t.type==="business"?"Business Account":"Standard Account"}),e.jsxs("div",{className:"modalGrid",children:[(()=>{const s=T(t);return e.jsxs("div",{className:"modalRow",children:[e.jsx("span",{className:"modalLabel",children:s.label}),e.jsx("span",{className:"modalValue",children:s.value})]})})(),e.jsxs("div",{className:"modalRow",children:[e.jsx("span",{className:"modalLabel",children:"Province"}),e.jsx("span",{className:"modalValue",children:t.province||"Not set"})]}),e.jsxs("div",{className:"modalRow",children:[e.jsx("span",{className:"modalLabel",children:"Town"}),e.jsx("span",{className:"modalValue",children:t.town||"Not set"})]}),e.jsxs("div",{className:"modalRow",children:[e.jsx("span",{className:"modalLabel",children:"Account Since"}),e.jsx("span",{className:"modalValue",children:$(t.account_since)})]})]})]})]})}):null]})}V.createRoot(document.getElementById("root")).render(e.jsx(R.StrictMode,{children:e.jsx(I,{})}));
