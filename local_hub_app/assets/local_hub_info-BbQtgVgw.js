import{r as l,j as s,a as Ls,b as vs,c as Bs,R as Hs}from"./localHub-DhdBYosn.js";import{b as V,s as K,a as $s,L as Ds,c as Ps,R as Es,d as As,e as Fs}from"./formatAbout-CrmeYvLb.js";import{g as G,t as q,a as L,l as k,b as Os,n as E,r as Us,f as Ts,c as Cs}from"./localHubInfoApi-D35QwRWF.js";/* empty css                    */const ws=[{value:"recent",label:"Most Recent"},{value:"highest",label:"Highest Rated"},{value:"lowest",label:"Lowest Rated"},{value:"helpful",label:"Most Helpful"}];function zs(o,c,x){return Math.max(c,Math.min(x,o))}function Ws(o){const c=o.length||0,x=c===0?0:o.reduce((f,m)=>f+(Number(m.rating)||0),0)/c,p={1:0,2:0,3:0,4:0,5:0};return o.forEach(f=>{const m=zs(Math.round(Number(f.rating)||0),1,5);p[m]+=1}),{total:c,avg:x,counts:p}}function Vs({rating:o}){return s.jsx("div",{className:"rev-stars","aria-label":`${o} stars`,children:Array.from({length:5},(c,x)=>x<o?s.jsx("i",{className:"fas fa-star"},x):s.jsx("i",{className:"far fa-star"},x))})}function Ks({reviews:o,ratingSummary:c,onReport:x,onHelpful:p,onReportReview:f}){var $;const[m,w]=l.useState("recent"),[j,_]=l.useState(!1),[I,U]=l.useState(()=>new Map),y=l.useRef(null);l.useEffect(()=>{function n(h){y.current&&(y.current.contains(h.target)||_(!1))}return document.addEventListener("click",n),()=>document.removeEventListener("click",n)},[]);const R=l.useMemo(()=>Array.isArray(o)?o:[],[o]),S=l.useMemo(()=>{const n=[...R],h=d=>Number(d.helpful||0)+(I.get(d.id)||0);return m==="highest"?n.sort((d,u)=>u.rating-d.rating||u.timestamp-d.timestamp):m==="lowest"?n.sort((d,u)=>d.rating-u.rating||u.timestamp-d.timestamp):m==="helpful"?n.sort((d,u)=>h(u)-h(d)||u.timestamp-d.timestamp):n.sort((d,u)=>u.timestamp-d.timestamp),n},[R,m,I]),g=l.useMemo(()=>Ws(R),[R]),B=c&&typeof c.avg=="number"?c.avg:g.avg,H=c&&typeof c.total=="number"?c.total:g.total,A=B?B.toFixed(1):"0.0",T=l.useMemo(()=>{const n=H||1;return[5,4,3,2,1].map(h=>{const d=c&&c.counts?Number(c.counts[h]||0):g.counts[h]||0,u=`${Math.round(d/n*100)}%`;return{star:h,count:d,width:u}})},[c,g,H]);return s.jsxs("section",{className:"collCard",children:[s.jsxs("div",{className:"collHead collHeadRow",children:[s.jsx("span",{children:"Reviews"}),s.jsxs("div",{className:"sort-box",ref:y,children:[s.jsx("span",{children:"Sort by:"}),s.jsxs("div",{className:`custom-dropdown ${j?"active":""}`,children:[s.jsxs("div",{className:"dropdown-trigger",role:"button",tabIndex:0,onClick:n=>{n.stopPropagation(),_(h=>!h)},onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&_(h=>!h)},children:[s.jsx("span",{children:(($=ws.find(n=>n.value===m))==null?void 0:$.label)||"Most Recent"}),s.jsx("i",{className:"fas fa-chevron-down"})]}),s.jsx("div",{className:"dropdown-menu",children:ws.map(n=>s.jsxs("div",{className:`dropdown-item ${n.value===m?"selected":""}`,onClick:()=>{w(n.value),_(!1)},children:[n.label," ",s.jsx("i",{className:"fas fa-check"})]},n.value))})]})]})]}),s.jsxs("div",{className:"rating-summary-card",children:[s.jsxs("div",{className:"summary-left",children:[s.jsx("span",{className:"big-num",children:A}),s.jsx("div",{className:"stars",children:Array.from({length:5},(n,h)=>s.jsx("i",{className:"fas fa-star",style:{color:"#fbbf24"}},h))}),s.jsxs("span",{className:"total-text",children:["Based on ",H," Reviews"]})]}),s.jsx("div",{className:"summary-bars",children:T.map(n=>s.jsxs("div",{className:"bar-row",children:[s.jsxs("span",{className:"bar-label",children:[n.star," ",s.jsx("i",{className:"fas fa-star",style:{color:"#fbbf24",fontSize:9}})]}),s.jsx("div",{className:"bar-bg",children:s.jsx("div",{className:"bar-fill",style:{width:n.width}})}),s.jsx("span",{className:"bar-count",children:n.count})]},n.star))})]}),s.jsx("div",{className:"rev-container",children:S.length?S.map(n=>{const h=I.get(n.id)||0;return s.jsxs("div",{className:"review-row",children:[s.jsx("div",{className:"rev-avatar",children:n.avatarUrl?s.jsx("img",{src:n.avatarUrl,alt:"User"}):n.initials}),s.jsxs("div",{style:{flex:1},children:[s.jsxs("div",{className:"rev-header",children:[s.jsx("span",{className:"rev-name",children:n.name}),s.jsx("span",{className:"rev-date",children:n.dateLabel})]}),s.jsx(Vs,{rating:n.rating}),s.jsx("p",{className:"rev-text",children:n.text}),s.jsxs("div",{className:"rev-actions",children:[s.jsxs("button",{type:"button",className:"btn-link-action",onClick:async()=>{try{await(p==null?void 0:p(n.id)),U(d=>{const u=new Map(d);return u.set(n.id,(u.get(n.id)||0)+1),u})}catch{}},children:[s.jsx("i",{className:"far fa-thumbs-up"})," Helpful"," ",s.jsxs("span",{style:{opacity:.7},children:["(",Number(n.helpful||0)+h,")"]})]}),s.jsxs("button",{type:"button",className:"btn-link-action",onClick:()=>f==null?void 0:f(n.id),children:[s.jsx("i",{className:"far fa-flag"})," Report"]})]})]})]},n.id)}):s.jsx("div",{style:{padding:14,color:"var(--muted)",fontWeight:800},children:"No reviews yet."})})]})}function Gs(){return s.jsxs("div",{className:"lh-skeleton",children:[s.jsxs("section",{className:"topCard",children:[s.jsx("div",{className:"topRow",children:s.jsxs("div",{className:"brand",children:[s.jsx("div",{className:"logo",children:s.jsx("div",{className:"sk sk-circle w-100 h-100"})}),s.jsxs("div",{className:"btxt",style:{width:"100%"},children:[s.jsx("div",{className:"sk sk-rect w-220 h-16"}),s.jsx("div",{style:{height:8}}),s.jsx("div",{className:"sk sk-rect w-420 h-12"}),s.jsxs("div",{className:"stats-row",style:{marginTop:12},children:[s.jsx("div",{className:"sk sk-pill w-120 h-14"}),s.jsx("div",{className:"sk sk-pill w-120 h-14"}),s.jsx("div",{className:"sk sk-pill w-120 h-14"}),s.jsx("div",{className:"sk sk-pill w-120 h-14"})]})]})]})}),s.jsxs("div",{className:"actions",style:{marginTop:14},children:[s.jsx("div",{className:"sk sk-btn w-110 h-44"}),s.jsx("div",{className:"sk sk-btn w-110 h-44"}),s.jsx("div",{className:"sk sk-btn w-110 h-44"}),s.jsx("div",{className:"sk sk-btn w-110 h-44"}),s.jsx("div",{className:"sk sk-btn w-110 h-44 sk-danger"})]})]}),s.jsxs("section",{className:"aboutCard",children:[s.jsx("div",{className:"sk sk-rect w-220 h-14"}),s.jsx("div",{style:{height:12}}),s.jsx("div",{className:"sk sk-rect w-full h-12"}),s.jsx("div",{style:{height:10}}),s.jsx("div",{className:"sk sk-rect w-full h-12"}),s.jsx("div",{style:{height:10}}),s.jsx("div",{className:"sk sk-rect w-420 h-12"}),s.jsxs("div",{className:"social-flex",style:{marginTop:12},children:[s.jsx("div",{className:"sk sk-rect w-52 h-52"}),s.jsx("div",{className:"sk sk-rect w-52 h-52"}),s.jsx("div",{className:"sk sk-rect w-52 h-52"}),s.jsx("div",{className:"sk sk-rect w-52 h-52"}),s.jsx("div",{className:"sk sk-rect w-52 h-52"})]})]}),s.jsxs("section",{className:"collCard",children:[s.jsx("div",{className:"sk sk-rect w-220 h-14"}),s.jsx("div",{className:"prodGrid",style:{marginTop:12},children:Array.from({length:4},(o,c)=>s.jsxs("div",{className:"prodCard",children:[s.jsx("div",{className:"sk sk-rect w-full h-150"}),s.jsxs("div",{style:{padding:12,display:"grid",gap:10},children:[s.jsx("div",{className:"sk sk-rect w-180 h-12"}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10},children:[s.jsx("div",{className:"sk sk-pill w-140 h-36"}),s.jsx("div",{className:"sk sk-rect w-36 h-36"})]})]})]},c))})]}),s.jsxs("section",{className:"collCard",children:[s.jsx("div",{className:"sk sk-rect w-180 h-14"}),s.jsx("div",{style:{height:12}}),s.jsx("div",{className:"sk sk-rect w-full h-280"})]}),s.jsxs("section",{className:"reviewsCard",children:[s.jsx("div",{className:"sk sk-rect w-180 h-14"}),s.jsx("div",{className:"rev-container",style:{marginTop:12},children:Array.from({length:2},(o,c)=>s.jsxs("div",{className:"review-row",children:[s.jsx("div",{className:"sk sk-circle w-44 h-44"}),s.jsxs("div",{style:{flex:1,display:"grid",gap:10},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10},children:[s.jsx("div",{className:"sk sk-rect w-180 h-12"}),s.jsx("div",{className:"sk sk-rect w-120 h-10"})]}),s.jsx("div",{className:"sk sk-pill w-160 h-12"}),s.jsx("div",{className:"sk sk-rect w-full h-40"}),s.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[s.jsx("div",{className:"sk sk-pill w-140 h-34"}),s.jsx("div",{className:"sk sk-pill w-140 h-34"})]})]})]},c))})]})]})}function qs(){var X,Y,Z,M,ss,as,es,ts,ns,is,cs,ls,rs,os,ds,us,hs,ms,xs,bs,ps,fs;const[o,c]=l.useState(!0),[x,p]=l.useState(""),[f,m]=l.useState(null),[w,j]=l.useState(""),[_,I]=l.useState(!1),[U,y]=l.useState(!1),[R,S]=l.useState(!1),[g,B]=l.useState(""),[H,A]=l.useState(!1),[T,$]=l.useState(!1),[n,h]=l.useState([]),[d,u]=l.useState(0),[_s,z]=l.useState(null);function J(e,t=0){h(e),u(t),$(!0)}function D(e){try{return new URL(`../${e}`,window.location.href).toString()}catch{return`../${e}`}}function Is(){try{const e=new URL("local_hub_followers.html",window.location.href);return e.search=window.location.search,e.hash=window.location.hash,e.toString()}catch{return"local_hub_followers.html"}}l.useEffect(()=>{let e=null;if(w)return e=setTimeout(()=>j(""),4e3),()=>{e&&clearTimeout(e)}},[w]);async function v({signal:e}={}){const t=G();if(!t){m(null),c(!1);return}c(!0),p("");try{const i=await Ts({businessId:t,signal:e});let C=Cs(i);if(!(i!=null&&i.viewer)&&L())try{const b=await k({action:"get_viewer_state",payload:{business_id:t},signal:e});b!=null&&b.viewer&&(C=Cs({...i,viewer:b.viewer}))}catch{}m(C)}catch(i){if(e!=null&&e.aborted)return;m(null),p(i instanceof Error?i.message:"Failed to load business details.")}finally{if(e!=null&&e.aborted)return;c(!1)}}l.useEffect(()=>{const e=new AbortController;return v({signal:e.signal}),()=>e.abort()},[]),l.useEffect(()=>{const e=G();e&&Ls({businessId:e})},[]);const W=G();if(!W)return s.jsx("div",{className:"page",children:s.jsx("div",{className:"frame",children:s.jsxs("section",{className:"aboutCard",style:{borderColor:"#fecaca"},children:[s.jsx("div",{className:"aboutHead",style:{color:"#b91c1c"},children:"Missing business_id"}),s.jsx("div",{className:"aboutBody",children:"Open this page with `?business_id=...`."})]})})});const a=f,P=_s??((X=a==null?void 0:a.viewer)==null?void 0:X.isSaved),Rs=((Y=a==null?void 0:a.viewer)==null?void 0:Y.actorType)==="business"&&((Z=a==null?void 0:a.viewer)==null?void 0:Z.actorId)&&(a==null?void 0:a.businessId)&&String(a.viewer.actorId)===String(a.businessId),Q=o&&!a&&!x;return s.jsxs("div",{className:"page",children:[s.jsxs("div",{className:"frame",children:[w?s.jsx("div",{style:{marginBottom:12,fontWeight:900,color:"#0f172a"},children:w}):null,x?s.jsxs("section",{className:"aboutCard",style:{borderColor:"#fecaca"},children:[s.jsx("div",{className:"aboutHead",style:{color:"#b91c1c"},children:"Failed to load business details"}),s.jsx("div",{className:"aboutBody",children:x})]}):null,Q?s.jsx(Gs,{}):null,Q?null:s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"topCard",children:[s.jsx("div",{className:"topRow",children:s.jsxs("div",{className:"brand",children:[s.jsx("div",{className:"logo",children:s.jsx("img",{src:(a==null?void 0:a.logoUrl)||"",alt:"Logo"})}),s.jsxs("div",{className:"btxt",children:[s.jsxs("h1",{className:"bizName",children:[s.jsx("span",{className:"bizNameText",children:(a==null?void 0:a.businessName)||(o?"Loading...":"Business")}),a!=null&&a.isVerified?s.jsxs("svg",{className:"verified-badge",width:"18",height:"18",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-label":"Verified business",title:"Verified business",children:[s.jsx("rect",{width:"24",height:"24",fill:"#000000",opacity:"0"}),s.jsxs("g",{transform:"translate(12 12) scale(0.42)",children:[s.jsx("polygon",{points:"5.62,-21 9.05,-15.69 15.37,-15.38 15.69,-9.06 21,-5.63 18.12,0 21,5.62 15.69,9.05 15.38,15.37 9.06,15.69 5.63,21 0,18.12 -5.62,21 -9.05,15.69 -15.37,15.38 -15.69,9.06 -21,5.63 -18.12,0 -21,-5.62 -15.69,-9.05 -15.38,-15.37 -9.06,-15.69 -5.63,-21 0,-18.12",fill:"#42a5f5",fillRule:"nonzero"}),s.jsx("g",{transform:"translate(-0.01 0.51)",children:s.jsx("polygon",{points:"-2.6,6.74 -9.09,0.25 -6.97,-1.87 -2.56,2.53 7,-6.74 9.09,-4.59",fill:"#ffffff",fillRule:"nonzero"})})]})]}):null]}),s.jsxs("div",{className:"addr",children:[s.jsxs("svg",{className:"pin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M12 21s7-4.35 7-11a7 7 0 1 0-14 0c0 6.65 7 11 7 11z"}),s.jsx("circle",{cx:"12",cy:"10",r:"2.5"})]}),(a==null?void 0:a.addressLine)||(o?"Loading...":"Address not provided")]}),s.jsxs("div",{className:"stats-row",children:[s.jsxs("button",{type:"button",className:"stats-item stats-link",onClick:()=>{window.location.href=Is()},children:[s.jsx("span",{className:"stats-val",children:((M=a==null?void 0:a.stats)==null?void 0:M.followers)??0})," Followers"]}),s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-val",children:(ss=a==null?void 0:a.stats)!=null&&ss.reviewCount?a.stats.averageRating.toFixed(1):"0.0"})," ","Rating"]}),s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-val",children:((as=a==null?void 0:a.stats)==null?void 0:as.likes)??0})," Likes"]}),s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-val",children:((es=a==null?void 0:a.stats)==null?void 0:es.reviewCount)??0})," Reviews"]})]})]})]})}),Rs?s.jsxs("div",{className:"actions owner-actions",children:[s.jsxs("button",{type:"button",className:"btn chat",onClick:()=>{window.location.href=D("business-chat-hub/index.html")},children:[s.jsx("i",{className:"fas fa-comment-dots"})," Chat"]}),s.jsxs("button",{type:"button",className:"btn profile",onClick:()=>{window.location.href=D("business_account_information.html")},children:[s.jsx("i",{className:"fas fa-user-circle"})," Profile"]}),s.jsxs("button",{type:"button",className:"btn analytics",onClick:()=>{window.location.href=D("business_analytics.html")},children:[s.jsx("i",{className:"fas fa-chart-line"})," Analytics"]}),s.jsxs("button",{type:"button",className:"btn alerts",onClick:()=>{window.location.href=D("business_communications.html")},children:[s.jsx("i",{className:"fas fa-bell"})," Alerts"]}),s.jsxs("button",{type:"button",className:"btn edit",onClick:()=>{window.location.href=D("business_post_management.html")},children:[s.jsx("i",{className:"fas fa-pen-to-square"})," Edit"]}),s.jsxs("button",{type:"button",className:"btn share",onClick:async()=>{const e=V({baseUrl:"/local_hub_app/",businessId:a==null?void 0:a.businessId,isMobile:!1}),t=await K({title:a!=null&&a.businessName?`${a.businessName} Ã¢â‚¬Â¢ LocalHub`:"LocalHub",text:a!=null&&a.businessName?`Check out ${a.businessName} on LocalHub.`:"Check this out on LocalHub.",url:e});(t.method==="copy"||t.method==="share")&&await q({businessId:a==null?void 0:a.businessId,method:t.method,url:e})},children:[s.jsx("i",{className:"fas fa-share-nodes"})," Share"]})]}):s.jsxs("div",{className:"actions",children:[s.jsxs("button",{type:"button",className:`btn follow${(ts=a==null?void 0:a.viewer)!=null&&ts.isFollowing?" following":""}`,disabled:!(a!=null&&a.businessId)||o,onClick:async()=>{var t;if(!(a!=null&&a.businessId))return;if(!L()){j("Please log in to continue.");return}try{const i=!((t=a==null?void 0:a.viewer)!=null&&t.isFollowing);await k({action:i?"follow_business":"unfollow_business",payload:{business_id:a.businessId}}),await v()}catch{}},children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M16 11l2 2 4-4"})]}),(ns=a==null?void 0:a.viewer)!=null&&ns.isFollowing?"Following":"Follow"]}),s.jsxs("button",{type:"button",className:"btn rate",onClick:()=>{if(!L()){j("Please log in to continue.");return}I(!0)},children:[s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("path",{d:"M12 17.3l-6.2 3.7 1.7-7L2 8.9l7.2-.6L12 2l2.8 6.3 7.2.6-5.5 5.1 1.7 7z"})}),"Rate"]}),s.jsxs("a",{href:Os({recipientId:a==null?void 0:a.businessId,recipientName:a==null?void 0:a.businessName}),className:"btn chat",onClick:e=>{L()||(e.preventDefault(),j("Please log in to continue."))},children:[s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("path",{d:"M21 15a4 4 0 0 1-4 4H7l-4 3V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"})}),"Chat"]}),s.jsxs("button",{type:"button",className:"btn share",onClick:async()=>{const e=V({baseUrl:"/local_hub_app/",businessId:a==null?void 0:a.businessId,isMobile:!1}),t=await K({title:a!=null&&a.businessName?`${a.businessName} â€¢ LocalHub`:"LocalHub",text:a!=null&&a.businessName?`Check out ${a.businessName} on LocalHub.`:"Check this out on LocalHub.",url:e});(t.method==="copy"||t.method==="share")&&await q({businessId:a==null?void 0:a.businessId,method:t.method,url:e})},children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("circle",{cx:"18",cy:"5",r:"3"}),s.jsx("circle",{cx:"6",cy:"12",r:"3"}),s.jsx("circle",{cx:"18",cy:"19",r:"3"}),s.jsx("path",{d:"M8.6 13.5l6.8 3.9M15.4 6.6L8.6 10.5"})]}),"Share"]}),s.jsxs("button",{type:"button",className:`btn save${P?" saved":""}`,disabled:!(a!=null&&a.businessId)||o,onClick:async()=>{if(!(a!=null&&a.businessId))return;if(!L()){j("Please log in to continue.");return}try{const i=!!!P;z(i),await k({action:i?"save_business":"unsave_business",payload:{business_id:a.businessId}}),await v(),z(null)}catch{z(!!P)}},children:[s.jsx("svg",{viewBox:"0 0 24 24",fill:P?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("path",{d:"M6 3h12a2 2 0 0 1 2 2v16l-8-4-8 4V5a2 2 0 0 1 2-2z"})}),P?"Saved":"Save"]}),s.jsxs("button",{type:"button",className:"btn report",onClick:()=>{if(!L()){j("Please log in to continue.");return}y(!0)},children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M4 22V4"}),s.jsx("path",{d:"M4 4h13l-1.5 4L17 12H4"})]}),"Report"]})]})]}),s.jsxs("section",{className:"aboutCard",children:[s.jsxs("div",{className:"aboutHead",children:["About ",(a==null?void 0:a.businessName)||"Business"]}),s.jsx("div",{className:"aboutBody",children:o?"Loading...":(()=>{const e=$s((a==null?void 0:a.aboutText)||"");return e.length?s.jsx("div",{className:"aboutRich",children:e.map((t,i)=>t.type==="heading"?s.jsx("div",{className:"aboutHeading",children:t.text},`h-${i}`):t.type==="list"?s.jsx("ul",{className:"aboutList",children:t.items.map((C,b)=>s.jsx("li",{children:C},`li-${i}-${b}`))},`l-${i}`):s.jsx("p",{className:"aboutPara",children:t.text},`p-${i}`))}):"No description provided."})()}),s.jsxs("div",{style:{marginTop:12},children:[a!=null&&a.businessHours?s.jsxs("div",{className:"hours-block",children:[s.jsx("div",{className:"aboutHead",children:"Business Hours"}),s.jsx("div",{className:"hours-text",children:a.businessHours})]}):null,a!=null&&a.addressLine?s.jsxs("div",{className:"address-block",children:[s.jsx("div",{className:"address-title",children:"Business Address"}),s.jsx("div",{className:"address-text",children:a.addressDisplay||a.addressLine})]}):null,s.jsx("div",{className:"aboutHead",children:"Connect with us"}),s.jsxs("div",{className:"social-flex",style:{padding:0,gap:10},children:[a!=null&&a.businessNumber?s.jsx("a",{href:`tel:${String(a.businessNumber).replace(/[^\d+]/g,"")}`,className:"social-item phone",children:s.jsx("i",{className:"fas fa-phone"})}):null,s.jsx("a",{href:E("facebook",(is=a==null?void 0:a.social)==null?void 0:is.facebook),className:"social-item fb",onClick:e=>{var t;(t=a==null?void 0:a.social)!=null&&t.facebook||e.preventDefault()},style:{display:(cs=a==null?void 0:a.social)!=null&&cs.facebook?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fab fa-facebook-f"})}),s.jsx("a",{href:E("twitter",(ls=a==null?void 0:a.social)==null?void 0:ls.twitter),className:"social-item tw",onClick:e=>{var t;(t=a==null?void 0:a.social)!=null&&t.twitter||e.preventDefault()},style:{display:(rs=a==null?void 0:a.social)!=null&&rs.twitter?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fa-brands fa-x-twitter"})}),s.jsx("a",{href:E("whatsapp",(os=a==null?void 0:a.social)==null?void 0:os.whatsapp),className:"social-item wa",onClick:e=>{var t;(t=a==null?void 0:a.social)!=null&&t.whatsapp||e.preventDefault()},style:{display:(ds=a==null?void 0:a.social)!=null&&ds.whatsapp?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fab fa-whatsapp"})}),s.jsx("a",{href:E("tiktok",(us=a==null?void 0:a.social)==null?void 0:us.tiktok),className:"social-item tt",onClick:e=>{var t;(t=a==null?void 0:a.social)!=null&&t.tiktok||e.preventDefault()},style:{display:(hs=a==null?void 0:a.social)!=null&&hs.tiktok?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fab fa-tiktok"})}),s.jsx("a",{href:E("instagram",(ms=a==null?void 0:a.social)==null?void 0:ms.instagram),className:"social-item ig",onClick:e=>{var t;(t=a==null?void 0:a.social)!=null&&t.instagram||e.preventDefault()},style:{display:(xs=a==null?void 0:a.social)!=null&&xs.instagram?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fab fa-instagram"})})]})]})]}),s.jsxs("section",{className:"collCard",children:[s.jsx("div",{className:"collHead",children:"Our Gallery"}),s.jsx("div",{className:"prodGrid",children:((a==null?void 0:a.products)||[]).map(e=>s.jsxs("div",{className:"prodCard",role:"group",children:[s.jsx("div",{className:"prodImg",style:{cursor:"zoom-in"},onClick:()=>{vs({businessId:(a==null?void 0:a.businessId)||W,productKey:e.title||"Product"}),J(e.images,0)},role:"button",tabIndex:0,onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(vs({businessId:(a==null?void 0:a.businessId)||W,productKey:e.title||"Product"}),J(e.images,0))},children:s.jsx("img",{src:e.cover,alt:e.title})}),s.jsxs("div",{className:"prodInfo",children:[s.jsx("div",{className:"prodName",children:e.title}),s.jsx("div",{className:"product-meta-row",children:s.jsx("div",{className:"product-actions",children:(()=>{var ks,ys,gs;const t=e.title||"Product",i=((ks=a==null?void 0:a.productReactions)==null?void 0:ks[t])||{},C=Number(i==null?void 0:i.total)||0,b=i!=null&&i.by_reaction&&typeof i.by_reaction=="object"?i.by_reaction:{},F=((gs=(ys=a==null?void 0:a.viewer)==null?void 0:ys.productReactions)==null?void 0:gs[t])||"",js=["ðŸ‘","â¤ï¸","ðŸ”¥"],Ss=js.map(r=>({reaction:r,count:Number((b==null?void 0:b[r])??0)||0})).filter(r=>r.count>0).sort((r,N)=>N.count-r.count).slice(0,3).map(r=>r.reaction),Ns=C>0;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"reaction-container",children:[s.jsx("div",{className:"reactions-popover small-popover",children:js.map(r=>s.jsx("span",{className:`emoji ${F===r?"active":""}`,onClick:async N=>{N.preventDefault(),N.stopPropagation();try{await k({action:"react_product",payload:{business_id:a==null?void 0:a.businessId,product_key:t,reaction:r,force_set:!0}}),await v()}catch{}},title:r,"aria-label":`React ${r}`,children:r},r))}),s.jsxs("div",{className:"btn-with-count",children:[s.jsx("button",{type:"button",className:"small-btn",onClick:async r=>{r.preventDefault(),r.stopPropagation();try{await k({action:"react_product",payload:{business_id:a==null?void 0:a.businessId,product_key:t,reaction:F||"â¤ï¸",force_set:!1}}),await v()}catch{}},"aria-label":"React",children:F?s.jsx("span",{className:"my-reaction-emoji",children:F}):s.jsx("i",{className:"far fa-heart"})}),Ns?s.jsx("div",{className:"emoji-stack",children:Ss.map(r=>s.jsx("span",{children:r},r))}):null,Ns?s.jsx("span",{className:"reaction-count",children:C}):null]})]}),s.jsx("button",{type:"button",className:"small-btn",title:"Share",onClick:r=>{r.preventDefault(),r.stopPropagation(),(async()=>{const N=V({baseUrl:"/local_hub_app/",businessId:a==null?void 0:a.businessId,isMobile:!1}),O=await K({title:a!=null&&a.businessName?`${a.businessName} â€¢ LocalHub`:"LocalHub",text:e!=null&&e.title?`Check out "${e.title}" on LocalHub.`:"Check this out on LocalHub.",url:N});(O.method==="copy"||O.method==="share")&&await q({businessId:a==null?void 0:a.businessId,method:O.method,url:N})})()},children:s.jsx("i",{className:"fas fa-share-nodes"})})]})})()})})]})]},e.title))})]}),s.jsx(Ds,{address:(a==null?void 0:a.addressLine)||""}),s.jsx(Ks,{reviews:(a==null?void 0:a.reviews)||[],ratingSummary:{total:((bs=a==null?void 0:a.stats)==null?void 0:bs.reviewCount)??0,avg:((ps=a==null?void 0:a.stats)==null?void 0:ps.averageRating)??0,counts:((fs=a==null?void 0:a.stats)==null?void 0:fs.ratingBreakdown)||null},onReport:()=>y(!0),onHelpful:async e=>{e&&(await k({action:"set_review_helpful",payload:{review_id:e,helpful:!0}}),await v())},onReportReview:e=>{B(String(e||"")),S(!0)}})]})]}),s.jsx(Ps,{open:T,slides:n,index:d,onPrev:()=>u(e=>(e-1+n.length)%n.length),onNext:()=>u(e=>(e+1)%n.length),onClose:()=>$(!1)}),s.jsx(Es,{open:R,onClose:()=>S(!1),busy:H,onSubmit:async({reason:e,details:t})=>{if(g){A(!0);try{await k({action:"report_review",payload:{review_id:g,reason:e||"other",details:t||""}}),S(!1),B("")}catch{}finally{A(!1)}}}}),s.jsx(As,{open:U,onClose:()=>y(!1),businessId:(a==null?void 0:a.businessId)||"",onSubmit:async({businessId:e,reason:t,details:i})=>{await Us({businessId:e,reason:t,details:i})}}),s.jsx(Fs,{open:_,onClose:()=>I(!1),businessId:(a==null?void 0:a.businessId)||"",onSubmit:async({businessId:e,rating:t,content:i})=>{await k({action:"upsert_review",payload:{business_id:e,rating:t,content:i}}),await v()}})]})}Bs.createRoot(document.getElementById("root")).render(s.jsx(Hs.StrictMode,{children:s.jsx(qs,{})}));
