import{r as l,j as s,a as fs,b as hs,c as bs,R as Ns}from"./localHub-Ddi82mor.js";import{g as A,l as w,a as ks,b as ys,c as ms,s as xs,n as B,L as gs,d as vs,R as Cs,e as Rs,r as ws,f as _s,h as Is,i as Ls}from"./localHubInfoApi-DEewpdAU.js";const ps=[{value:"recent",label:"Most Recent"},{value:"highest",label:"Highest Rated"},{value:"lowest",label:"Lowest Rated"}];function Ss(o,c,x){return Math.max(c,Math.min(x,o))}function Bs(o){const c=o.length||0,x=c===0?0:o.reduce((j,m)=>j+(Number(m.rating)||0),0)/c,p={1:0,2:0,3:0,4:0,5:0};return o.forEach(j=>{const m=Ss(Math.round(Number(j.rating)||0),1,5);p[m]+=1}),{total:c,avg:x,counts:p}}function Es({rating:o}){return s.jsx("div",{className:"rev-stars","aria-label":`${o} stars`,children:Array.from({length:5},(c,x)=>x<o?s.jsx("i",{className:"fas fa-star"},x):s.jsx("i",{className:"far fa-star"},x))})}function Fs({reviews:o,ratingSummary:c,onReport:x,onHelpful:p,onReportReview:j}){var L;const[m,y]=l.useState("recent"),[u,g]=l.useState(!1),[E,D]=l.useState(()=>new Map),N=l.useRef(null);l.useEffect(()=>{function t(i){N.current&&(N.current.contains(i.target)||g(!1))}return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[]);const v=l.useMemo(()=>Array.isArray(o)?o:[],[o]),C=l.useMemo(()=>{const t=[...v];return m==="highest"?t.sort((i,h)=>h.rating-i.rating||h.timestamp-i.timestamp):m==="lowest"?t.sort((i,h)=>i.rating-h.rating||h.timestamp-i.timestamp):t.sort((i,h)=>h.timestamp-i.timestamp),t},[v,m]),k=l.useMemo(()=>Bs(v),[v]),_=c&&typeof c.avg=="number"?c.avg:k.avg,I=c&&typeof c.total=="number"?c.total:k.total,F=_?_.toFixed(1):"0.0",O=l.useMemo(()=>{const t=I||1;return[5,4,3,2,1].map(i=>{const h=c&&c.counts?Number(c.counts[i]||0):k.counts[i]||0,f=`${Math.round(h/t*100)}%`;return{star:i,count:h,width:f}})},[c,k,I]);return s.jsxs("section",{className:"collCard",children:[s.jsxs("div",{className:"collHead collHeadRow",children:[s.jsxs("span",{children:[s.jsx("i",{className:"fas fa-star"})," Reviews"]}),s.jsxs("div",{className:"sort-box",ref:N,children:[s.jsx("span",{children:"Sort by:"}),s.jsxs("div",{className:`custom-dropdown ${u?"active":""}`,children:[s.jsxs("div",{className:"dropdown-trigger",role:"button",tabIndex:0,onClick:t=>{t.stopPropagation(),g(i=>!i)},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&g(i=>!i)},children:[s.jsx("span",{children:((L=ps.find(t=>t.value===m))==null?void 0:L.label)||"Most Recent"}),s.jsx("i",{className:"fas fa-chevron-down"})]}),s.jsx("div",{className:"dropdown-menu",children:ps.map(t=>s.jsxs("div",{className:`dropdown-item ${t.value===m?"selected":""}`,onClick:()=>{y(t.value),g(!1)},children:[t.label," ",s.jsx("i",{className:"fas fa-check"})]},t.value))})]})]})]}),s.jsxs("div",{className:"rating-summary-card",children:[s.jsxs("div",{className:"summary-left",children:[s.jsx("span",{className:"big-num",children:F}),s.jsx("div",{className:"stars",children:Array.from({length:5},(t,i)=>s.jsx("i",{className:"fas fa-star",style:{color:"#fbbf24"}},i))}),s.jsxs("span",{className:"total-text",children:["Based on ",I," Reviews"]})]}),s.jsx("div",{className:"summary-bars",children:O.map(t=>s.jsxs("div",{className:"bar-row",children:[s.jsxs("span",{className:"bar-label",children:[t.star," ",s.jsx("i",{className:"fas fa-star",style:{color:"#fbbf24",fontSize:9}})]}),s.jsx("div",{className:"bar-bg",children:s.jsx("div",{className:"bar-fill",style:{width:t.width}})}),s.jsx("span",{className:"bar-count",children:t.count})]},t.star))})]}),s.jsx("div",{className:"rev-container",children:C.length?C.map(t=>{const i=E.get(t.id)||0;return s.jsxs("div",{className:"review-row",children:[s.jsx("div",{className:"rev-avatar",children:t.avatarUrl?s.jsx("img",{src:t.avatarUrl,alt:"User"}):t.initials}),s.jsxs("div",{style:{flex:1},children:[s.jsxs("div",{className:"rev-header",children:[s.jsx("span",{className:"rev-name",children:t.name}),s.jsx("span",{className:"rev-date",children:t.dateLabel})]}),s.jsx(Es,{rating:t.rating}),s.jsx("p",{className:"rev-text",children:t.text}),s.jsxs("div",{className:"rev-actions",children:[s.jsxs("button",{type:"button",className:"btn-link-action",onClick:async()=>{try{await(p==null?void 0:p(t.id)),D(h=>{const f=new Map(h);return f.set(t.id,(f.get(t.id)||0)+1),f})}catch{}},children:[s.jsx("i",{className:"far fa-thumbs-up"})," Helpful"," ",s.jsxs("span",{style:{opacity:.7},children:["(",Number(t.helpful||0)+i,")"]})]}),s.jsxs("button",{type:"button",className:"btn-link-action",onClick:()=>j==null?void 0:j(t.id),children:[s.jsx("i",{className:"far fa-flag"})," Report"]})]})]})]},t.id)}):s.jsx("div",{style:{padding:14,color:"var(--muted)",fontWeight:800},children:"No reviews yet."})})]})}function Hs(){return s.jsxs("div",{className:"lh-skeleton",children:[s.jsxs("section",{className:"topCard",children:[s.jsx("div",{className:"topRow",children:s.jsxs("div",{className:"brand",children:[s.jsx("div",{className:"logo",children:s.jsx("div",{className:"sk sk-circle w-100 h-100"})}),s.jsxs("div",{className:"btxt",style:{width:"100%"},children:[s.jsx("div",{className:"sk sk-rect w-220 h-16"}),s.jsx("div",{style:{height:8}}),s.jsx("div",{className:"sk sk-rect w-420 h-12"}),s.jsxs("div",{className:"stats-row",style:{marginTop:12},children:[s.jsx("div",{className:"sk sk-pill w-120 h-14"}),s.jsx("div",{className:"sk sk-pill w-120 h-14"}),s.jsx("div",{className:"sk sk-pill w-120 h-14"}),s.jsx("div",{className:"sk sk-pill w-120 h-14"})]})]})]})}),s.jsxs("div",{className:"actions",style:{marginTop:14},children:[s.jsx("div",{className:"sk sk-btn w-110 h-44"}),s.jsx("div",{className:"sk sk-btn w-110 h-44"}),s.jsx("div",{className:"sk sk-btn w-110 h-44"}),s.jsx("div",{className:"sk sk-btn w-110 h-44"}),s.jsx("div",{className:"sk sk-btn w-110 h-44 sk-danger"})]})]}),s.jsxs("section",{className:"aboutCard",children:[s.jsx("div",{className:"sk sk-rect w-220 h-14"}),s.jsx("div",{style:{height:12}}),s.jsx("div",{className:"sk sk-rect w-full h-12"}),s.jsx("div",{style:{height:10}}),s.jsx("div",{className:"sk sk-rect w-full h-12"}),s.jsx("div",{style:{height:10}}),s.jsx("div",{className:"sk sk-rect w-420 h-12"}),s.jsxs("div",{className:"social-flex",style:{marginTop:12},children:[s.jsx("div",{className:"sk sk-rect w-52 h-52"}),s.jsx("div",{className:"sk sk-rect w-52 h-52"}),s.jsx("div",{className:"sk sk-rect w-52 h-52"}),s.jsx("div",{className:"sk sk-rect w-52 h-52"}),s.jsx("div",{className:"sk sk-rect w-52 h-52"})]})]}),s.jsxs("section",{className:"collCard",children:[s.jsx("div",{className:"sk sk-rect w-220 h-14"}),s.jsx("div",{className:"prodGrid",style:{marginTop:12},children:Array.from({length:4},(o,c)=>s.jsxs("div",{className:"prodCard",children:[s.jsx("div",{className:"sk sk-rect w-full h-150"}),s.jsxs("div",{style:{padding:12,display:"grid",gap:10},children:[s.jsx("div",{className:"sk sk-rect w-180 h-12"}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10},children:[s.jsx("div",{className:"sk sk-pill w-140 h-36"}),s.jsx("div",{className:"sk sk-rect w-36 h-36"})]})]})]},c))})]}),s.jsxs("section",{className:"collCard",children:[s.jsx("div",{className:"sk sk-rect w-180 h-14"}),s.jsx("div",{style:{height:12}}),s.jsx("div",{className:"sk sk-rect w-full h-280"})]}),s.jsxs("section",{className:"reviewsCard",children:[s.jsx("div",{className:"sk sk-rect w-180 h-14"}),s.jsx("div",{className:"rev-container",style:{marginTop:12},children:Array.from({length:2},(o,c)=>s.jsxs("div",{className:"review-row",children:[s.jsx("div",{className:"sk sk-circle w-44 h-44"}),s.jsxs("div",{style:{flex:1,display:"grid",gap:10},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10},children:[s.jsx("div",{className:"sk sk-rect w-180 h-12"}),s.jsx("div",{className:"sk sk-rect w-120 h-10"})]}),s.jsx("div",{className:"sk sk-pill w-160 h-12"}),s.jsx("div",{className:"sk sk-rect w-full h-40"}),s.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[s.jsx("div",{className:"sk sk-pill w-140 h-34"}),s.jsx("div",{className:"sk sk-pill w-140 h-34"})]})]})]},c))})]})]})}function Ds(){var $,z,V,K,G,Y,q,J,Q,X,Z,M,ss,es,as,ts,ns,cs;const[o,c]=l.useState(!0),[x,p]=l.useState(""),[j,m]=l.useState(null),[y,u]=l.useState(""),[g,E]=l.useState(!1),[D,N]=l.useState(!1),[v,C]=l.useState(!1),[k,_]=l.useState(""),[I,F]=l.useState(!1),[O,L]=l.useState(!1),[t,i]=l.useState([]),[h,f]=l.useState(0);function P(a,n=0){i(a),f(n),L(!0)}l.useEffect(()=>{let a=null;if(y)return a=setTimeout(()=>u(""),4e3),()=>{a&&clearTimeout(a)}},[y]);async function R({signal:a}={}){const n=A();if(!n){m(null),c(!1);return}c(!0),p("");try{const d=await Is({businessId:n,signal:a});m(Ls(d))}catch(d){if(a!=null&&a.aborted)return;m(null),p(d instanceof Error?d.message:"Failed to load business details.")}finally{if(a!=null&&a.aborted)return;c(!1)}}l.useEffect(()=>{const a=new AbortController;return R({signal:a.signal}),()=>a.abort()},[]),l.useEffect(()=>{const a=A();a&&fs({businessId:a})},[]);const T=A();if(!T)return s.jsx("div",{className:"page",children:s.jsx("div",{className:"frame",children:s.jsxs("section",{className:"aboutCard",style:{borderColor:"#fecaca"},children:[s.jsx("div",{className:"aboutHead",style:{color:"#b91c1c"},children:"Missing business_id"}),s.jsx("div",{className:"aboutBody",children:"Open this page with `?business_id=...`."})]})})});const e=j,W=o&&!e&&!x;return s.jsxs("div",{className:"page",children:[s.jsxs("div",{className:"frame",children:[y?s.jsx("div",{style:{marginBottom:12,fontWeight:900,color:"#0f172a"},children:y}):null,x?s.jsxs("section",{className:"aboutCard",style:{borderColor:"#fecaca"},children:[s.jsx("div",{className:"aboutHead",style:{color:"#b91c1c"},children:"Failed to load business details"}),s.jsx("div",{className:"aboutBody",children:x})]}):null,W?s.jsx(Hs,{}):null,W?null:s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"topCard",children:[s.jsx("div",{className:"topRow",children:s.jsxs("div",{className:"brand",children:[s.jsx("div",{className:"logo",children:s.jsx("img",{src:(e==null?void 0:e.logoUrl)||"",alt:"Logo"})}),s.jsxs("div",{className:"btxt",children:[s.jsx("h1",{children:(e==null?void 0:e.businessName)||(o?"Loading...":"Business")}),s.jsxs("div",{className:"addr",children:[s.jsxs("svg",{className:"pin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M12 21s7-4.35 7-11a7 7 0 1 0-14 0c0 6.65 7 11 7 11z"}),s.jsx("circle",{cx:"12",cy:"10",r:"2.5"})]}),(e==null?void 0:e.addressLine)||(o?"Loading...":"Address not provided")]}),s.jsxs("div",{className:"stats-row",children:[s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-val",children:(($=e==null?void 0:e.stats)==null?void 0:$.followers)??0})," Followers"]}),s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-val",children:(z=e==null?void 0:e.stats)!=null&&z.reviewCount?e.stats.averageRating.toFixed(1):"0.0"})," ","Rating"]}),s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-val",children:((V=e==null?void 0:e.stats)==null?void 0:V.likes)??0})," Likes"]}),s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-val",children:((K=e==null?void 0:e.stats)==null?void 0:K.reviewCount)??0})," Reviews"]})]})]})]})}),s.jsxs("div",{className:"actions",children:[s.jsxs("button",{type:"button",className:"btn primary",disabled:!(e!=null&&e.businessId)||o,onClick:async()=>{var a;if(e!=null&&e.businessId)try{const n=!((a=e==null?void 0:e.viewer)!=null&&a.isFollowing);await w({action:n?"follow_business":"unfollow_business",payload:{business_id:e.businessId}}),u(n?"Following":"Unfollowed"),await R()}catch(n){u(n instanceof Error?n.message:"Failed to update follow.")}},children:[s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("path",{d:"M20 6L9 17l-5-5"})}),(G=e==null?void 0:e.viewer)!=null&&G.isFollowing?"Following":"Follow"]}),s.jsxs("button",{type:"button",className:"btn",onClick:()=>E(!0),children:[s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("path",{d:"M12 17.3l-6.2 3.7 1.7-7L2 8.9l7.2-.6L12 2l2.8 6.3 7.2.6-5.5 5.1 1.7 7z"})}),"Rate"]}),s.jsxs("a",{href:ys({recipientId:e==null?void 0:e.businessId,recipientName:e==null?void 0:e.businessName}),className:"btn",onClick:a=>{ks()||(a.preventDefault(),u("Please log in to continue."))},children:[s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("path",{d:"M21 15a4 4 0 0 1-4 4H7l-4 3V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"})}),"Chat"]}),s.jsxs("button",{type:"button",className:"btn",onClick:async()=>{const a=ms({baseUrl:"/local_hub_app/",businessId:e==null?void 0:e.businessId,isMobile:!1}),n=await xs({title:e!=null&&e.businessName?`${e.businessName} â€¢ LocalHub`:"LocalHub",text:e!=null&&e.businessName?`Check out ${e.businessName} on LocalHub.`:"Check this out on LocalHub.",url:a});n.method==="copy"?u("Link copied."):n.method==="share"&&u("Shared.")},children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("circle",{cx:"18",cy:"5",r:"3"}),s.jsx("circle",{cx:"6",cy:"12",r:"3"}),s.jsx("circle",{cx:"18",cy:"19",r:"3"}),s.jsx("path",{d:"M8.6 13.5l6.8 3.9M15.4 6.6L8.6 10.5"})]}),"Share"]}),s.jsxs("button",{type:"button",className:"btn danger",onClick:()=>N(!0),children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M4 22V4"}),s.jsx("path",{d:"M4 4h13l-1.5 4L17 12H4"})]}),"Report"]})]})]}),s.jsxs("section",{className:"aboutCard",children:[s.jsxs("div",{className:"aboutHead",children:["About ",(e==null?void 0:e.businessName)||"Business"]}),s.jsx("div",{className:"aboutBody",children:o?"Loading...":(e==null?void 0:e.aboutText)||"No description provided."}),s.jsxs("div",{style:{marginTop:12},children:[s.jsx("div",{className:"aboutHead",children:"Connect with us"}),s.jsxs("div",{className:"social-flex",style:{padding:0,gap:10},children:[s.jsx("a",{href:B("facebook",(Y=e==null?void 0:e.social)==null?void 0:Y.facebook),className:"social-item fb",onClick:a=>{var n;(n=e==null?void 0:e.social)!=null&&n.facebook||a.preventDefault()},style:{display:(q=e==null?void 0:e.social)!=null&&q.facebook?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fab fa-facebook-f"})}),s.jsx("a",{href:B("twitter",(J=e==null?void 0:e.social)==null?void 0:J.twitter),className:"social-item tw",onClick:a=>{var n;(n=e==null?void 0:e.social)!=null&&n.twitter||a.preventDefault()},style:{display:(Q=e==null?void 0:e.social)!=null&&Q.twitter?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fa-brands fa-x-twitter"})}),s.jsx("a",{href:B("whatsapp",(X=e==null?void 0:e.social)==null?void 0:X.whatsapp),className:"social-item wa",onClick:a=>{var n;(n=e==null?void 0:e.social)!=null&&n.whatsapp||a.preventDefault()},style:{display:(Z=e==null?void 0:e.social)!=null&&Z.whatsapp?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fab fa-whatsapp"})}),s.jsx("a",{href:B("tiktok",(M=e==null?void 0:e.social)==null?void 0:M.tiktok),className:"social-item tt",onClick:a=>{var n;(n=e==null?void 0:e.social)!=null&&n.tiktok||a.preventDefault()},style:{display:(ss=e==null?void 0:e.social)!=null&&ss.tiktok?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fab fa-tiktok"})}),s.jsx("a",{href:B("instagram",(es=e==null?void 0:e.social)==null?void 0:es.instagram),className:"social-item ig",onClick:a=>{var n;(n=e==null?void 0:e.social)!=null&&n.instagram||a.preventDefault()},style:{display:(as=e==null?void 0:e.social)!=null&&as.instagram?"":"none"},target:"_blank",rel:"noopener",children:s.jsx("i",{className:"fab fa-instagram"})})]})]})]}),s.jsxs("section",{className:"collCard",children:[s.jsx("div",{className:"collHead",children:"Featured Collections"}),s.jsx("div",{className:"prodGrid",children:((e==null?void 0:e.products)||[]).map(a=>s.jsxs("div",{className:"prodCard",role:"group",children:[s.jsx("div",{className:"prodImg",style:{cursor:"zoom-in"},onClick:()=>{hs({businessId:(e==null?void 0:e.businessId)||T,productKey:a.title||"Product"}),P(a.images,0)},role:"button",tabIndex:0,onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(hs({businessId:(e==null?void 0:e.businessId)||T,productKey:a.title||"Product"}),P(a.images,0))},children:s.jsx("img",{src:a.cover,alt:a.title})}),s.jsxs("div",{className:"prodInfo",children:[s.jsx("div",{className:"prodName",children:a.title}),s.jsx("div",{className:"product-meta-row",children:s.jsx("div",{className:"product-actions",children:(()=>{var os,ds,us;const n=a.title||"Product",d=((os=e==null?void 0:e.productReactions)==null?void 0:os[n])||{},rs=Number(d==null?void 0:d.total)||0,U=d!=null&&d.by_reaction&&typeof d.by_reaction=="object"?d.by_reaction:{},H=((us=(ds=e==null?void 0:e.viewer)==null?void 0:ds.productReactions)==null?void 0:us[n])||"",ls=["ðŸ‘","â¤ï¸","ðŸ”¥"],js=ls.map(r=>({reaction:r,count:Number((U==null?void 0:U[r])??0)||0})).filter(r=>r.count>0).sort((r,b)=>b.count-r.count).slice(0,3).map(r=>r.reaction),is=rs>0;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"reaction-container",children:[s.jsx("div",{className:"reactions-popover small-popover",children:ls.map(r=>s.jsx("span",{className:`emoji ${H===r?"active":""}`,onClick:async b=>{b.preventDefault(),b.stopPropagation();try{await w({action:"react_product",payload:{business_id:e==null?void 0:e.businessId,product_key:n,reaction:r,force_set:!0}}),await R()}catch(S){u(S instanceof Error?S.message:"Failed to react.")}},title:r,"aria-label":`React ${r}`,children:r},r))}),s.jsxs("div",{className:"btn-with-count",children:[s.jsx("button",{type:"button",className:"small-btn",onClick:async r=>{r.preventDefault(),r.stopPropagation();try{await w({action:"react_product",payload:{business_id:e==null?void 0:e.businessId,product_key:n,reaction:H||"â¤ï¸",force_set:!1}}),await R()}catch(b){u(b instanceof Error?b.message:"Failed to react.")}},"aria-label":"React",children:H?s.jsx("span",{className:"my-reaction-emoji",children:H}):s.jsx("i",{className:"far fa-heart"})}),is?s.jsx("div",{className:"emoji-stack",children:js.map(r=>s.jsx("span",{children:r},r))}):null,is?s.jsx("span",{className:"reaction-count",children:rs}):null]})]}),s.jsx("button",{type:"button",className:"small-btn",title:"Share",onClick:r=>{r.preventDefault(),r.stopPropagation(),(async()=>{const b=ms({baseUrl:"/local_hub_app/",businessId:e==null?void 0:e.businessId,isMobile:!1}),S=await xs({title:e!=null&&e.businessName?`${e.businessName} â€¢ LocalHub`:"LocalHub",text:a!=null&&a.title?`Check out "${a.title}" on LocalHub.`:"Check this out on LocalHub.",url:b});S.method==="copy"?u("Link copied."):S.method==="share"&&u("Shared.")})()},children:s.jsx("i",{className:"fas fa-share-nodes"})})]})})()})})]})]},a.title))})]}),s.jsx(gs,{address:(e==null?void 0:e.addressLine)||""}),s.jsx(Fs,{reviews:(e==null?void 0:e.reviews)||[],ratingSummary:{total:((ts=e==null?void 0:e.stats)==null?void 0:ts.reviewCount)??0,avg:((ns=e==null?void 0:e.stats)==null?void 0:ns.averageRating)??0,counts:((cs=e==null?void 0:e.stats)==null?void 0:cs.ratingBreakdown)||null},onReport:()=>N(!0),onHelpful:async a=>{a&&(await w({action:"set_review_helpful",payload:{review_id:a,helpful:!0}}),await R())},onReportReview:a=>{_(String(a||"")),C(!0)}})]})]}),s.jsx(vs,{open:O,slides:t,index:h,onPrev:()=>f(a=>(a-1+t.length)%t.length),onNext:()=>f(a=>(a+1)%t.length),onClose:()=>L(!1)}),s.jsx(Cs,{open:v,onClose:()=>C(!1),busy:I,onSubmit:async({reason:a,details:n})=>{if(k){F(!0);try{await w({action:"report_review",payload:{review_id:k,reason:a||"other",details:n||""}}),u("Review reported. Thank you."),C(!1),_("")}catch(d){u(d instanceof Error?d.message:"Failed to submit report.")}finally{F(!1)}}}}),s.jsx(Rs,{open:D,onClose:()=>N(!1),businessId:(e==null?void 0:e.businessId)||"",onSubmit:async({businessId:a,reason:n,details:d})=>{await ws({businessId:a,reason:n,details:d}),u("Report received. Our team will review this business shortly.")}}),s.jsx(_s,{open:g,onClose:()=>E(!1),businessId:(e==null?void 0:e.businessId)||"",onSubmit:async({businessId:a,rating:n,content:d})=>{await w({action:"upsert_review",payload:{business_id:a,rating:n,content:d}}),u("Success! Your review has been submitted."),await R()}})]})}bs.createRoot(document.getElementById("root")).render(s.jsx(Ns.StrictMode,{children:s.jsx(Ds,{})}));
